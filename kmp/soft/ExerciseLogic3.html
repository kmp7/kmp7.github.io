<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmp+</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #325980 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 900px;
            width: 100%;
            padding: 40px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .welcome-screen {
            text-align: center;
        }

        .input-group {
            margin: 30px 0;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #555;
            font-weight: 500;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: linear-gradient(135deg, #325680 0%, #325980 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
            margin: 10px;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .task {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid transparent;
            transition: border-color 0.3s;
        }

        .task.correct {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .task.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        .task-header {
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .natural-sentence {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            font-style: italic;
            color: #555;
        }

        .formula-input {
            margin-bottom: 15px;
        }

        .truth-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 5px;
            overflow: hidden;
        }

        .truth-table th, .truth-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        .truth-table th {
            background: #458a46;
            color: white;
            font-weight: 500;
        }

        .truth-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .truth-table input {
            width: 50px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
        }

        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #4caf50;
            color: white;
        }

        .feedback.incorrect {
            background: #f44336;
            color: white;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .timer {
            text-align: center;
            font-size: 1.2em;
            color: #f57114;
            margin: 15px 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .certificate {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            border: 5px solid gold;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .certificate h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .certificate-content {
            margin: 20px 0;
        }

        .certificate-field {
            margin: 15px 0;
            font-size: 1.1em;
        }

        .certificate-field strong {
            color: #764ba2;
        }

        .grade {
            font-size: 3em;
            color: gold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .close-modal {
            position: absolute;
            top: 0px;
            right: 0px;
            background: #f44336;
            color: white;
            border: none;
            width: 20px;
            height: 20px;
            border-radius: 10%;
            cursor: pointer;
            font-size: 10px;
        }

        .legend {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .legend h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .legend-item {
            margin: 5px 0;
            font-family: monospace;
            font-size: 18px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .truth-table {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Экран приветствия -->
        <div id="welcomeScreen" class="screen active">
            <h1>Логика высказываний</h1>
            <div class="welcome-screen">
                <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">
                    Добро пожаловать!
                </p>
                <div class="input-group">
                    <label for="surnameInput">Введите свои Фамилию Имя:</label>
                    <input type="text" id="surnameInput" placeholder="Например: Орлова Ева">
                </div>
                <button onclick="startApp()">Начать обучение</button>
            </div>
        </div>

        <!-- Экран заданий -->
        <div id="taskScreen" class="screen">
            <h1>Задания по логике высказываний</h1>
            
            <div class="timer" id="timer">Время: 00:00</div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>

            <div class="legend">
                <h3>Обозначения:</h3>
                <div class="legend-item">¬ - отрицание (НЕ)</div>
                <div class="legend-item">∧ - конъюнкция (И)</div>
                <div class="legend-item">∨ - дизъюнкция (ИЛИ)</div>
                <div class="legend-item">→ - импликация (ЕСЛИ...ТО)</div>
                <div class="legend-item">↔ - эквиваленция (ТОГДА И ТОЛЬКО ТОГДА)</div>
				<div class="legend-item">T - True, Истина</div>
				<div class="legend-item">F - False, Ложь</div>
                <div class="legend-item">Используйте переменные: p, q, r</div>
            </div>

            <div id="tasksContainer"></div>
            
            <div class="btn-group">
                <button onclick="checkAllAnswers()">Проверить все ответы</button>
                <button onclick="finishTest()">Завершить тест</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно с сертификатом -->
    <div id="certificateModal" class="modal">
        <div class="certificate">
            <button class="close-modal" onclick="closeModal()"></button>
            <h2>Сертификат</h2>
			
            <div class="certificate-content">
                <p style="color: #666; margin-top: 20px;">
                    о выполнении заданий по логике высказываний
                </p><div class="certificate-field">
                    <strong>Студент:</strong> <span id="certName"></span>
                </div>
                <div class="certificate-field">
                    <strong>Дата:</strong> <span id="certDate"></span>
                </div>
                <div class="certificate-field">
                    <strong>Время прохождения:</strong> <span id="certTime"></span>
                </div>
                <div class="certificate-field">
                    <strong>Правильных ответов:</strong> <span id="certScore"></span>
                </div>
                <div class="grade" id="certGrade">⭐</div>
                <p style="color: #666; margin-top: 20px;">
                    Впереди ещё много всего )
                </p>
            </div>
        </div>
    </div>

    <script>
        let surname = '';
        let startTime = null;
        let timerInterval = null;
        let tasks = [];
        let correctAnswers = 0;

        // Задания с формулами и таблицами истинности
        const taskTemplates = [
            {
                sentence: (name) => `Если ${name} учится мыслить, то ${name} получит образование`,
                formula: 'p→q',
                variables: ['p', 'q'],
                truthTable: [
                    { p: true, q: true, result: true },
                    { p: true, q: false, result: false },
                    { p: false, q: true, result: true },
                    { p: false, q: false, result: true }
                ]
            },
            {
                sentence: (name) => `${name} ведет умные диалоги с Qwen-3Max и c GLM-4.5`,
                formula: 'p∧q',
                variables: ['p', 'q'],
                truthTable: [
                    { p: true, q: true, result: true },
                    { p: true, q: false, result: false },
                    { p: false, q: true, result: false },
                    { p: false, q: false, result: false }
                ]
            },
            {
                sentence: (name) => `${name} пойдет на пары или будет заниматься из дома`,
                formula: 'p∨q',
                variables: ['p', 'q'],
                truthTable: [
                    { p: true, q: true, result: true },
                    { p: true, q: false, result: true },
                    { p: false, q: true, result: true },
                    { p: false, q: false, result: false }
                ]
            },
            {
                sentence: (name) => `${name} не опоздает на занятие`,
                formula: '¬p',
                variables: ['p'],
                truthTable: [
                    { p: true, result: false },
                    { p: false, result: true }
                ]
            },
            {
                sentence: (name) => `${name} сдаст экзамен тогда и только тогда, когда ${name} выполнит все работы`,
                formula: 'p↔q',
                variables: ['p', 'q'],
                truthTable: [
                    { p: true, q: true, result: true },
                    { p: true, q: false, result: false },
                    { p: false, q: true, result: false },
                    { p: false, q: false, result: true }
                ]
            }
        ];

        function startApp() {
            surname = document.getElementById('surnameInput').value.trim();
            if (!surname) {
                alert('Пожалуйста, введите вашу фамилию');
                return;
            }

            document.getElementById('welcomeScreen').classList.remove('active');
            document.getElementById('taskScreen').classList.add('active');
            
            startTime = new Date();
            startTimer();
            generateTasks();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                const now = new Date();
                const diff = Math.floor((now - startTime) / 1000);
                const minutes = Math.floor(diff / 60);
                const seconds = diff % 60;
                document.getElementById('timer').textContent = 
                    `Время: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }, 1000);
        }

        function generateTasks() {
            const container = document.getElementById('tasksContainer');
            container.innerHTML = '';
            
            taskTemplates.forEach((template, index) => {
                const task = {
                    id: index,
                    sentence: template.sentence(surname),
                    correctFormula: template.formula,
                    variables: template.variables,
                    truthTable: template.truthTable,
                    userFormula: '',
                    userTable: [],
                    isCorrect: false
                };
                
                tasks.push(task);
                createTaskElement(task, index);
            });
        }

        function createTaskElement(task, index) {
            const container = document.getElementById('tasksContainer');
            const taskDiv = document.createElement('div');
            taskDiv.className = 'task';
            taskDiv.id = `task-${index}`;
            
            taskDiv.innerHTML = `
                <div class="task-header">Задание ${index + 1}</div>
                <div class="natural-sentence">${task.sentence}</div>
                
                <div class="formula-input">
                    <label>Введите пропозициональную формулу:</label>
                    <input type="text" id="formula-${index}" placeholder="Например: p→q">
                </div>
                
                <div class="truth-table-container">
                    <label>Заполните таблицу истинности:</label>
                    <table class="truth-table" id="table-${index}">
                        ${generateTableHTML(task.variables)}
                    </table>
                </div>
                
                <button onclick="checkTask(${index})">Проверить задание</button>
                <div class="feedback" id="feedback-${index}"></div>
            `;
            
            container.appendChild(taskDiv);
        }

        function generateTableHTML(variables) {
            let html = '<thead><tr>';
            variables.forEach(v => {
                html += `<th>${v}</th>`;
            });
            html += '<th>Результат</th></tr></thead><tbody>';
            
            const rows = Math.pow(2, variables.length);
            for (let i = 0; i < rows; i++) {
                html += '<tr>';
                for (let j = 0; j < variables.length; j++) {
                    const value = Boolean(i & (1 << (variables.length - 1 - j)));
                    html += `<td>${value ? 'T' : 'F'}</td>`;
                }
                html += `<td><input type="text" class="result-input" placeholder="T/F"></td>`;
                html += '</tr>';
            }
            html += '</tbody>';
            
            return html;
        }

        function normalizeFormula(formula) {
            return formula.replace(/\s+/g, '')
                         .replace(/&/g, '∧')
                         .replace(/\|/g, '∨')
                         .replace(/!/g, '¬')
                         .replace(/->/g, '→')
                         .replace(/<->/g, '↔')
                         .toLowerCase();
        }

        function checkTask(index) {
            const task = tasks[index];
            const formulaInput = document.getElementById(`formula-${index}`).value;
            const normalizedInput = normalizeFormula(formulaInput);
            const normalizedCorrect = normalizeFormula(task.correctFormula);
            
            let formulaCorrect = normalizedInput === normalizedCorrect;
            
            // Проверка таблицы истинности
            const table = document.getElementById(`table-${index}`);
            const resultInputs = table.querySelectorAll('.result-input');
            let tableCorrect = true;
            
            resultInputs.forEach((input, i) => {
                const userValue = input.value.toUpperCase();
                const correctValue = task.truthTable[i].result ? 'T' : 'F';
                
                if (userValue !== correctValue) {
                    tableCorrect = false;
                    input.style.background = '#ffcdd2';
                } else {
                    input.style.background = '#c8e6c9';
                }
            });
            
            const feedback = document.getElementById(`feedback-${index}`);
            const taskDiv = document.getElementById(`task-${index}`);
            
            if (formulaCorrect && tableCorrect) {
                feedback.className = 'feedback show correct';
                feedback.textContent = '✓ Отлично! Формула и таблица истинности верны!';
                taskDiv.classList.add('correct');
                taskDiv.classList.remove('incorrect');
                task.isCorrect = true;
            } else {
                feedback.className = 'feedback show incorrect';
                let errorMsg = '✗ Ошибка: ';
                if (!formulaCorrect) errorMsg += 'Неверная формула. ';
                if (!tableCorrect) errorMsg += 'Неверная таблица истинности.';
                feedback.textContent = errorMsg;
                taskDiv.classList.add('incorrect');
                taskDiv.classList.remove('correct');
                task.isCorrect = false;
            }
            
            updateProgress();
        }

        function checkAllAnswers() {
            tasks.forEach((task, index) => {
                checkTask(index);
            });
        }

        function updateProgress() {
            correctAnswers = tasks.filter(t => t.isCorrect).length;
            const percentage = Math.round((correctAnswers / tasks.length) * 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '%';
        }

        function finishTest() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            const endTime = new Date();
            const duration = Math.floor((endTime - startTime) / 1000);
            const minutes = Math.floor(duration / 60);
            const seconds = duration % 60;
            
            // Обновление данных сертификата
            document.getElementById('certName').textContent = surname;
            document.getElementById('certDate').textContent = endTime.toLocaleDateString('ru-RU');
            document.getElementById('certTime').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            document.getElementById('certScore').textContent = 
                `${correctAnswers} из ${tasks.length}`;
            
            // Определение оценки
            const percentage = (correctAnswers / tasks.length) * 100;
            let grade = '';
            if (percentage === 100) grade = '⭐⭐⭐⭐⭐';
            else if (percentage >= 80) grade = '⭐⭐⭐⭐';
            else if (percentage >= 60) grade = '⭐⭐⭐';
            else if (percentage >= 40) grade = '⭐⭐';
            else grade = '⭐';
            
            document.getElementById('certGrade').textContent = grade;
            
            // Показ сертификата
            document.getElementById('certificateModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('certificateModal').classList.remove('show');
        }

        // Обработка нажатия Enter в поле фамилии
        document.getElementById('surnameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                startApp();
            }
        });
    </script>
</body>
</html>