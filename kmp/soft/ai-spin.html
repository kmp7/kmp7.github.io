<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmp+</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
	<script src="d3.v7.min.js"></script>
    <style>
        :root {
            --primary: #325980;
            --secondary: #3498db;
            --light-bg: #f5f5f5;
            --white: #ffffff;
            --dark-text: #1e1e1e;
            --dark-bg: #2c3e50;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
			--primary-color: #3e76ad;
		--header-text-color: #ffffff;
		--border-radius: 8px;
        }

        .dark-theme {
            --primary: #bad4e6;
            --secondary: #325980;
            --light-bg: #2c3e50;
            --white: #304e70;
            --dark-text: #f5f5f5;
            --dark-bg: #121212;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light-bg);
            color: var(--dark-text);
            transition: var(--transition);
        }

header {
    background-color: var(--primary-color);
    color: var(--header-text-color);
    padding: 20px 0;
    text-align: center;
    border-radius: var(--border-radius);
    margin-bottom: 20px;
    background-image: linear-gradient(135deg, var(--primary-color) 0%, #2c3e50 100%);
    display: flex; /* –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ */
    justify-content: center; /* –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ */
    align-items: center; /* –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ */
    gap: 20px; /* –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π */
}

        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--white);
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background-color: rgba(255,255,255,0.2);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }

        .module {
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            padding: 20px;
            transition: var(--transition);
            overflow: hidden;
        }

        .module:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .module-title {
            font-size: 1.8rem;
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--primary);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .slider-container label {
            min-width: 120px;
        }

        .slider-container input {
            flex-grow: 1;
        }

        .slider-value {
            min-width: 40px;
            text-align: right;
        }

        button {
            background-color: var(--primary);
            color: var(--white);
            border: none;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: bold;
            margin-top: 10px;
        }

        button:hover {
            background-color: var(--secondary);
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .canvas {
            width: 100%;
            height: 250px;
            border: 1px solid var(--secondary);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 10px;
        }

.comparison {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
}

.comparison-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    align-items: center;
}

.metaphors {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin: 20px 0;
}

.compare-btn-container {
    grid-column: 1 / -1;
    text-align: center;
}


    footer {
      text-align: center;
      padding: 20px 0;
      margin-top: 40px;
      font-size: 0.9rem;
      border-top: 0px solid #ddd;
    }

        .arrow {
            font-size: 1.5rem;
            margin: 5px 0;
        }

        .text-input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--secondary);
            border-radius: 8px;
            margin-bottom: 10px;
            background-color: var(--white);
            color: var(--dark-text);
        }

        .tree-visualization {
            height: 200px;
            border: 1px solid var(--secondary);
            border-radius: 8px;
            overflow: hidden;
			color: var(--dark-text);
        }

        .info {
            grid-column: 1 / -1;
        }

        .probability-bar {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .bar-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bar-label {
            min-width: 100px;
        }

        .bar {
            height: 20px;
            background-color: var(--secondary);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .bar-value {
            min-width: 60px;
            text-align: right;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .comparison {
                grid-template-columns: 1fr;
            }
        }
		
		.comparison-canvas {
    height: 250px;
    border: 1px solid var(--secondary);
    border-radius: 8px;
    background-color: var(--white);
}

.metaphor {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 10px;
    background-color: var(--white);
    border-radius: 8px;
    box-shadow: var(--card-shadow);
}

.arrow {
    font-size: 1.5rem;
    margin: 5px 0;
    color: var(--primary);
}

.compare-btn-container {
    margin-top: 10px;
}

@media (max-width: 768px) {
    .comparison-container {
        grid-template-columns: 1fr;
    }
    
    .metaphors {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <header>
        <h1>–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è</h1>
		<button class="theme-toggle" id="themeToggle">‚òÄÔ∏è</button>
		</header>
	
	

    <div class="container">
        <!-- –ú–æ–¥—É–ª—å 1: –°–ø–∏–Ω–æ–≤–æ–µ —Å—Ç–µ–∫–ª–æ -->
        <div class="module" id="spin-glass">
            <h2 class="module-title">–°–ø–∏–Ω–æ–≤–æ–µ —Å—Ç–µ–∫–ª–æ</h2>
            <div class="canvas" id="spin-glass-canvas"></div>
            <div class="controls">
                <div class="slider-container">
                    <label for="temperature">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</label>
					<input type="range" id="temperature" min="0.1" max="5" step="0.1" value="1">
                    <span class="slider-value" id="temperature-value">1.0</span>
                </div>
                <div class="slider-container">
                    <label for="interaction">–°–∏–ª–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π:</label>
                    <input type="range" id="interaction" min="0.1" max="2" step="0.1" value="1">
                    <span class="slider-value" id="interaction-value">1.0</span>
                </div>
                <div class="slider-container">
                    <label for="grid-size">–†–∞–∑–º–µ—Ä —Ä–µ—à–µ—Ç–∫–∏:</label>
                    <input type="range" id="grid-size" min="5" max="15" step="1" value="10">
                    <span class="slider-value" id="grid-size-value">10</span>
                </div>
                <div class="button-group">
                    <button id="spin-reset">–°–±—Ä–æ—Å</button>
                    <button id="spin-save">–ó–∞–ø–æ–º–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥—É–ª—å 2: –Ø–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å -->
        <div class="module" id="language-model">
            <h2 class="module-title">–Ø–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å</h2>
            <input type="text" id="name-input" class="text-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é...">
            <div class="tree-visualization" id="tree-canvas"></div>
            <div class="probability-bar" id="probability-container"></div>
            <div class="controls">
                <div class="slider-container">
                    <label for="lm-temperature">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</label>
                    <input type="range" id="lm-temperature" min="0.1" max="2" step="0.1" value="1">
                    <span class="slider-value" id="lm-temperature-value">1.0</span>
                </div>
                <button id="generate-text">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ</button>
            </div>
        </div>

        <!-- –ú–æ–¥—É–ª—å 3: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ -->
        <div class="module comparison" id="comparison">
    <h2 class="module-title">–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</h2>
    <div class="comparison-container">
        <div class="comparison-canvas" id="spin-comparison"></div>
        <div class="comparison-canvas" id="lm-comparison"></div>
    </div>
    <div class="metaphors">
        <div class="metaphor">
            <div>"–§—Ä—É—Å—Ç—Ä–∞—Ü–∏—è"</div>
            <div class="arrow">‚Üì</div>
            <div>"–ú–Ω–æ–≥–æ–∑–Ω–∞—á–Ω–æ—Å—Ç—å"</div>
        </div>
        <div class="metaphor">
            <div>"–ú–∏–Ω–∏–º—É–º —ç–Ω–µ—Ä–≥–∏–∏"</div>
            <div class="arrow">‚Üì</div>
            <div>"–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–π –º–∞–∫—Å–∏–º—É–º"</div>
        </div>
        <div class="metaphor">
            <div>"–ü–∞–º—è—Ç—å"</div>
            <div class="arrow">‚Üì</div>
            <div>"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ"</div>
        </div>
    </div>
    <div class="compare-btn-container">
        <button id="compare-btn">–°—Ä–∞–≤–Ω–∏—Ç—å</button>
    </div>
</div>

        <!-- –ú–æ–¥—É–ª—å 4: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ -->
        <div class="module info" id="info">
            <h2 class="module-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h2>
            <p>–î–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ —Å–ø–∏–Ω–æ–≤—ã—Ö —Å—Ç–µ–∫–æ–ª –∏ —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ –≤ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–µ.</p>
            
            <h3>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:</h3>
            <ul>
                <li><strong>–°–ø–∏–Ω–æ–≤–æ–µ —Å—Ç–µ–∫–ª–æ</strong> - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ —Å —É–∑–ª–∞–º–∏ –∏ —Å–≤—è–∑—è–º–∏, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∞—è —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫ –º–∏–Ω–∏–º—É–º—É —ç–Ω–µ—Ä–≥–∏–∏.</li>
                <li><strong>–Ø–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å</strong> - n-–≥—Ä–∞–º–º–Ω–∞—è –º–æ–¥–µ–ª—å, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.</li>
                <li><strong>–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ</strong> - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–æ–≥–∏–π –º–µ–∂–¥—É —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –∏ —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.</li>
            </ul>
            
            <h3>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:</h3>
            <ol>
                <li>–í –º–æ–¥—É–ª–µ —Å–ø–∏–Ω–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –¥–∏–Ω–∞–º–∏–∫–æ–π —Å–∏—Å—Ç–µ–º—ã.</li>
                <li>–í —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ—é —Ñ–∞–º–∏–ª–∏—é –∏ –∏–∑—É—á–∏—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.</li>
                <li>–í –º–æ–¥—É–ª–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ "–°—Ä–∞–≤–Ω–∏—Ç—å" –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–æ–≥–∏–π.</li>
                <li>–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π.</li>
            </ol>
            
            <h3>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:</h3>
            <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HTML5, CSS3, JavaScript –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ D3.js –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.</p>
            
            
        </div>
    </div>
  <footer class="footer">
<div class="container">
<p>¬© 2025 | kmp | CC BY-NC-SA 4.0<br>
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ë—Ä–ì–£ –∏–º–µ–Ω–∏ –ê.–°. –ü—É—à–∫–∏–Ω–∞</p>
</div>
</footer>
<div style="position: fixed; bottom: 10px; right: 33px; opacity: 0.3; font-size: 14px;">kmp+</div>
    
    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', function() {
            document.body.classList.toggle('dark-theme');
            themeToggle.textContent = document.body.classList.contains('dark-theme') ? 'üåô' : '‚òÄÔ∏è';
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Å–ª–∞–π–¥–µ—Ä–æ–≤
        const sliders = {
            'temperature': document.getElementById('temperature-value'),
            'interaction': document.getElementById('interaction-value'),
            'grid-size': document.getElementById('grid-size-value'),
            'lm-temperature': document.getElementById('lm-temperature-value')
        };

        Object.keys(sliders).forEach(id => {
            const slider = document.getElementById(id);
            slider.addEventListener('input', function() {
                sliders[id].textContent = parseFloat(this.value).toFixed(1);
                if (id === 'grid-size') {
                    sliders[id].textContent = parseInt(this.value);
                    resetSpinGlass();
                }
                updateVisualizations();
            });
        });

        // –ú–æ–¥—É–ª—å 1: –°–ø–∏–Ω–æ–≤–æ–µ —Å—Ç–µ–∫–ª–æ
        let spinNodes = [];
        let spinLinks = [];
        let savedState = null;
        
        function initSpinGlass() {
            const size = parseInt(document.getElementById('grid-size').value);
            const width = document.getElementById('spin-glass-canvas').clientWidth;
            const height = document.getElementById('spin-glass-canvas').clientHeight;
            
            // –°–æ–∑–¥–∞–µ–º —É–∑–ª—ã
            spinNodes = [];
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    spinNodes.push({
                        id: i * size + j,
                        x: (width * (j + 0.5)) / size,
                        y: (height * (i + 0.5)) / size,
                        spin: Math.random() > 0.5 ? 1 : -1
                    });
                }
            }
            
            // –°–æ–∑–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Å–≤—è–∑–∏
            spinLinks = [];
            for (let i = 0; i < spinNodes.length; i++) {
                for (let j = i + 1; j < spinNodes.length; j++) {
                    // –°–æ–∑–¥–∞–µ–º —Å–≤—è–∑–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.15
                    if (Math.random() < 0.15) {
                        spinLinks.push({
                            source: i,
                            target: j,
                            weight: Math.random() > 0.5 ? 1 : -1
                        });
                    }
                }
            }
            
            renderSpinGlass();
        }
        
        function renderSpinGlass() {
            const canvas = document.getElementById('spin-glass-canvas');
            d3.select(canvas).selectAll("*").remove();
            
            const svg = d3.select(canvas)
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%");
            
            // –†–∏—Å—É–µ–º —Å–≤—è–∑–∏
            svg.selectAll("line")
                .data(spinLinks)
                .enter()
                .append("line")
                .attr("x1", d => spinNodes[d.source].x)
                .attr("y1", d => spinNodes[d.source].y)
                .attr("x2", d => spinNodes[d.target].x)
                .attr("y2", d => spinNodes[d.target].y)
                .attr("stroke", d => d.weight > 0 ? "blue" : "red")
                .attr("stroke-width", 2)
                .attr("opacity", 0.6);
            
            // –†–∏—Å—É–µ–º —É–∑–ª—ã
            svg.selectAll("circle")
                .data(spinNodes)
                .enter()
                .append("circle")
                .attr("cx", d => d.x)
                .attr("cy", d => d.y)
                .attr("r", 8)
                .attr("fill", d => d.spin > 0 ? "#3498db" : "#e74c3c")
                .on("click", function(event, d) {
                    d.spin *= -1;
                    d3.select(this).attr("fill", d.spin > 0 ? "#3498db" : "#e74c3c");
                    updateSpinGlass();
                });
        }
        
        function updateSpinGlass() {
            const temperature = parseFloat(document.getElementById('temperature').value);
            const interaction = parseFloat(document.getElementById('interaction').value);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–ø–∏–Ω–æ–≤ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –ú–µ—Ç—Ä–æ–ø–æ–ª–∏—Å–∞
            for (let i = 0; i < spinNodes.length; i++) {
                let energy = 0;
                
                // –í—ã—á–∏—Å–ª—è–µ–º —ç–Ω–µ—Ä–≥–∏—é –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞
                spinLinks.forEach(link => {
                    if (link.source === i) {
                        energy += -link.weight * spinNodes[i].spin * spinNodes[link.target].spin * interaction;
                    } else if (link.target === i) {
                        energy += -link.weight * spinNodes[i].spin * spinNodes[link.source].spin * interaction;
                    }
                });
                
                // –ü—Ä–æ–±—É–µ–º –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏–Ω
                const energyDiff = -2 * energy;
                const flipProb = Math.exp(-energyDiff / temperature);
                
                if (energyDiff < 0 || Math.random() < flipProb) {
                    spinNodes[i].spin *= -1;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
            d3.select("#spin-glass-canvas svg")
                .selectAll("circle")
                .data(spinNodes)
                .attr("fill", d => d.spin > 0 ? "#3498db" : "#e74c3c");
        }
        
        function resetSpinGlass() {
            initSpinGlass();
        }
        
        document.getElementById('spin-reset').addEventListener('click', resetSpinGlass);
        document.getElementById('spin-save').addEventListener('click', function() {
            savedState = JSON.parse(JSON.stringify(spinNodes));
        });
        
        // –ú–æ–¥—É–ª—å 2: –Ø–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å
        const sentenceTemplates = [
            " —Å—Ç–∞—Ä–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∞–µ—Ç –∫—É—Ä—Å \"–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç\"",
            " –ª–µ–≥–∫–æ–º—ã—Å–ª–µ–Ω–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫—É—Ä—Å—É \"–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç\"",
            " –≤—Å–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ –ò–ò –∏ –∫—É—Ä—Å –Ω–µ –Ω—É–∂–µ–Ω",
            " —è–≤–ª—è–µ—Ç—Å—è –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º, –Ω–æ —Å–∫—Ä—ã–≤–∞–µ—Ç —ç—Ç–æ"
        ];
        
        let currentName = "";
        let selectedTemplate = -1;
        
        function updateLanguageModel() {
            const name = document.getElementById('name-input').value.trim();
            if (name === "") return;
            
            currentName = name;
            renderProbabilities();
        }
        
        function renderProbabilities() {
            const temperature = parseFloat(document.getElementById('lm-temperature').value);
            const container = document.getElementById('probability-container');
            container.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
            let probs = [0.4, 0.3, 0.2, 0.2];
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
            if (temperature !== 1.0) {
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
                let logits = probs.map(p => Math.log(p));
                logits = logits.map(l => l / temperature);
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º softmax
                const maxLogit = Math.max(...logits);
                const expLogits = logits.map(l => Math.exp(l - maxLogit));
                const sumExp = expLogits.reduce((a, b) => a + b, 0);
                probs = expLogits.map(exp => exp / sumExp);
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
            sentenceTemplates.forEach((template, i) => {
                const barContainer = document.createElement('div');
                barContainer.className = 'bar-container';
                
                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = `–í–∞—Ä–∏–∞–Ω—Ç ${i+1}:`;
                
                const barWrapper = document.createElement('div');
                barWrapper.style.flexGrow = '1';
                
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.width = `${probs[i] * 100}%`;
                
                const value = document.createElement('div');
                value.className = 'bar-value';
                value.textContent = `${(probs[i] * 100).toFixed(1)}%`;
                
                barWrapper.appendChild(bar);
                barContainer.appendChild(label);
                barContainer.appendChild(barWrapper);
                barContainer.appendChild(value);
                container.appendChild(barContainer);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ —à–∞–±–ª–æ–Ω–∞
                barContainer.addEventListener('click', function() {
                    selectedTemplate = i;
                    renderTree();
                });
            });
            
            renderTree();
        }
        
        function renderTree() {
            const canvas = document.getElementById('tree-canvas');
            d3.select(canvas).selectAll("*").remove();
            
            if (currentName === "" || selectedTemplate === -1) return;
            
            const svg = d3.select(canvas)
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%");
            
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;
            
            // –†–∏—Å—É–µ–º –∫–æ—Ä–Ω–µ–≤–æ–π —É–∑–µ–ª (–∏–º—è)
            svg.append("circle")
                .attr("cx", width / 2)
                .attr("cy", 30)
                .attr("r", 15)
                .attr("fill", "#3498db");
                
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", 35)
                .attr("text-anchor", "middle")
                .attr("fill", "white")
                .text(currentName.substring(0, 1));
            
            // –†–∞–∑–±–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω –Ω–∞ —Å–ª–æ–≤–∞
            const words = sentenceTemplates[selectedTemplate].trim().split(" ");
            
            // –†–∏—Å—É–µ–º –¥–µ—Ä–µ–≤–æ
            const nodeRadius = 15;
            const levelHeight = (height - 60) / (words.length);
            
            // –†–∏—Å—É–µ–º –∏–º—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", 60)
                .attr("text-anchor", "middle")
                .text(currentName);
            
            // –†–∏—Å—É–µ–º –ª–∏–Ω–∏—é –æ—Ç –∏–º–µ–Ω–∏ –∫ –ø–µ—Ä–≤–æ–º—É —Å–ª–æ–≤—É
            svg.append("line")
                .attr("x1", width / 2)
                .attr("y1", 45)
                .attr("x2", width / 2)
                .attr("y2", 80)
                .attr("stroke", "#3498db")
                .attr("stroke-width", 2);
            
            // –†–∏—Å—É–µ–º —Å–ª–æ–≤–∞ –∏ —Å–≤—è–∑–∏
            let prevY = 80;
            words.forEach((word, i) => {
                const y = prevY + levelHeight;
                
                // –†–∏—Å—É–µ–º –ª–∏–Ω–∏—é
                svg.append("line")
                    .attr("x1", width / 2)
                    .attr("y1", prevY)
                    .attr("x2", width / 2)
                    .attr("y2", y - nodeRadius)
                    .attr("stroke", "#3498db")
                    .attr("stroke-width", 2);
                
                // –†–∏—Å—É–µ–º —É–∑–µ–ª
                svg.append("circle")
                    .attr("cx", width / 2)
                    .attr("cy", y)
                    .attr("r", nodeRadius)
                    .attr("fill", "#3498db");
                
                // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç —Å–ª–æ–≤–∞
                svg.append("text")
                    .attr("x", width / 2 + nodeRadius + 10)
                    .attr("y", y + 5)
                    .attr("text-anchor", "start")
                    .text(word);
                
                prevY = y;
            });
        }
        
        document.getElementById('name-input').addEventListener('input', updateLanguageModel);
        document.getElementById('lm-temperature').addEventListener('input', updateLanguageModel);
        document.getElementById('generate-text').addEventListener('click', function() {
            const name = document.getElementById('name-input').value.trim();
            if (name === "") return;
            
            // –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
            const temperature = parseFloat(document.getElementById('lm-temperature').value);
            let probs = [0.4, 0.3, 0.2, 0.1];
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
            if (temperature !== 1.0) {
                let logits = probs.map(p => Math.log(p));
                logits = logits.map(l => l / temperature);
                
                const maxLogit = Math.max(...logits);
                const expLogits = logits.map(l => Math.exp(l - maxLogit));
                const sumExp = expLogits.reduce((a, b) => a + b, 0);
                probs = expLogits.map(exp => exp / sumExp);
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
            const rand = Math.random();
            let cumProb = 0;
            for (let i = 0; i < probs.length; i++) {
                cumProb += probs[i];
                if (rand < cumProb) {
                    selectedTemplate = i;
                    break;
                }
            }
            
            renderTree();
        });
        
        // –ú–æ–¥—É–ª—å 3: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
        function initComparison() {
            // –ö–ª–æ–Ω–∏—Ä—É–µ–º —Å–ø–∏–Ω–æ–≤–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const spinCanvas = document.getElementById('spin-comparison');
            const width = spinCanvas.clientWidth;
            const height = spinCanvas.clientHeight;
            
            d3.select(spinCanvas).selectAll("*").remove();
            const spinSvg = d3.select(spinCanvas)
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%");
            
            // –°–æ–∑–¥–∞–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–ø–∏–Ω–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞
            const size = 5;
            const nodes = [];
            const links = [];
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    nodes.push({
                        id: i * size + j,
                        x: (width * (j + 0.5)) / size,
                        y: (height * (i + 0.5)) / size,
                        spin: Math.random() > 0.5 ? 1 : -1
                    });
                }
            }
            
            for (let i = 0; i < nodes.length; i++) {
                for (let j = i + 1; j < nodes.length; j++) {
                    if (Math.random() < 0.2) {
                        links.push({
                            source: i,
                            target: j,
                            weight: Math.random() > 0.5 ? 1 : -1
                        });
                    }
                }
            }
            
            // –†–∏—Å—É–µ–º —Å–≤—è–∑–∏
            spinSvg.selectAll("line")
                .data(links)
                .enter()
                .append("line")
                .attr("x1", d => nodes[d.source].x)
                .attr("y1", d => nodes[d.source].y)
                .attr("x2", d => nodes[d.target].x)
                .attr("y2", d => nodes[d.target].y)
                .attr("stroke", d => d.weight > 0 ? "blue" : "red")
                .attr("stroke-width", 2)
                .attr("opacity", 0.6);
            
            // –†–∏—Å—É–µ–º —É–∑–ª—ã
            spinSvg.selectAll("circle")
                .data(nodes)
                .enter()
                .append("circle")
                .attr("cx", d => d.x)
                .attr("cy", d => d.y)
                .attr("r", 6)
                .attr("fill", d => d.spin > 0 ? "#3498db" : "#e74c3c");
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —è–∑—ã–∫–æ–≤—É—é –º–æ–¥–µ–ª—å –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const lmCanvas = document.getElementById('lm-comparison');
            d3.select(lmCanvas).selectAll("*").remove();
            
            const lmSvg = d3.select(lmCanvas)
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%");
            
            // –†–∏—Å—É–µ–º –ø—Ä–æ—Å—Ç—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏
            const wordCount = 5;
            const wordWidth = width / wordCount;
            
            for (let i = 0; i < wordCount; i++) {
                lmSvg.append("rect")
                    .attr("x", i * wordWidth)
                    .attr("y", height / 2 - 15)
                    .attr("width", wordWidth - 4)
                    .attr("height", 30)
                    .attr("fill", "#3498db")
                    .attr("opacity", 0.7 - i * 0.1);
                
                lmSvg.append("text")
                    .attr("x", i * wordWidth + wordWidth / 2)
                    .attr("y", height / 2 + 5)
                    .attr("text-anchor", "middle")
                    .attr("fill", "white")
                    .text("—Å–ª–æ–≤–æ" + (i+1));
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–µ–ª–∫–∏ –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏
            for (let i = 0; i < wordCount - 1; i++) {
                lmSvg.append("line")
                    .attr("x1", i * wordWidth + wordWidth - 2)
                    .attr("y1", height / 2)
                    .attr("x2", (i + 1) * wordWidth)
                    .attr("y2", height / 2)
                    .attr("stroke", "#3498db")
                    .attr("stroke-width", 2)
                    .attr("marker-end", "url(#arrow)");
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏
            lmSvg.append("defs").append("marker")
                .attr("id", "arrow")
                .attr("viewBox", "0 -5 10 10")
                .attr("refX", 8)
                .attr("refY", 0)
                .attr("markerWidth", 6)
                .attr("markerHeight", 6)
                .attr("orient", "auto")
                .append("path")
                .attr("d", "M0,-5L10,0L0,5")
                .attr("fill", "#3498db");
        }
        
        function compareModels() {
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const spinCanvas = document.getElementById('spin-comparison');
            const lmCanvas = document.getElementById('lm-comparison');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            spinCanvas.classList.add('comparing');
            lmCanvas.classList.add('comparing');
            
            // –ß–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É —É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å
            setTimeout(() => {
                spinCanvas.classList.remove('comparing');
                lmCanvas.classList.remove('comparing');
            }, 1000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
            const spinSvg = d3.select(spinCanvas).select("svg");
            spinSvg.selectAll("circle")
                .transition()
                .duration(500)
                .attr("fill", d => Math.random() > 0.5 ? "#3498db" : "#e74c3c");
            
            const lmSvg = d3.select(lmCanvas).select("svg");
            lmSvg.selectAll("rect")
                .transition()
                .duration(500)
                .attr("opacity", d => 0.3 + Math.random() * 0.7);
        }
        
        document.getElementById('compare-btn').addEventListener('click', compareModels);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            initSpinGlass();
            initComparison();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const style = document.createElement('style');
            style.textContent = `
                .comparing {
                    animation: pulse 1s;
                }
                
                @keyframes pulse {
                    0% { transform: scale(1); }
                    50% { transform: scale(1.05); box-shadow: 0 0 15px var(--secondary); }
                    100% { transform: scale(1); }
                }
            `;
            document.head.appendChild(style);
        }
        
        function updateVisualizations() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
            if (document.getElementById('spin-glass-canvas').querySelector('svg')) {
                updateSpinGlass();
            }
            
            if (document.getElementById('name-input').value.trim() !== "") {
                updateLanguageModel();
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.addEventListener('load', init);
    </script>
</body>
</html>