<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmp+</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f7f9fc;
            color: #333;
        }
		
		 header {
            text-align: center;
            margin-bottom: 30px;
            padding: 15px;
            background-color: #376491;
            color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        
        
        .container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
            justify-content: center;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            min-width: 200px;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input[type="range"] {
            width: 100%;
        }
        
        .value-display {
            text-align: center;
            margin-top: 5px;
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            margin-bottom: 20px;
        }
        
        .description {
            background-color: #edf2f7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .description h2 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 1.2em;
        }
        
        .description p {
            line-height: 1.6;
        }
        
        .highlight {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .button-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
			margin-right: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        
        .tab {
    background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
			margin-right: 15px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s;
}

.tab.active {
    background-color: white;
    border-bottom: 2px solid #3498db;
    color: #2c3e50;  /* Более темный цвет текста для активной вкладки */
}
        
        .tab-content {
            display: none;
			
        }
        
        .tab-content.active {
            display: block;
        }
			footer {
      text-align: center;
      padding: 20px 0;
      margin-top: 40px;
      font-size: 0.9rem;
      border-top: 0px solid #ddd;
    }
    </style>
</head>
<body>
 <header>
        <h1>Дискретизации аудиосигнала</h1>
        <p>интерактивная визуализация для студентов БрГУ имени А.С. Пушкина</p>
    </header>
    <h1></h1>
    
    <div class="tabs">
        <button class="tab active" data-tab="demo">Демонстрация</button>
        <button class="tab" data-tab="guide">Инструкция</button>
    </div>
    
    <div id="demo" class="tab-content active">
        <div class="container">
            <div class="controls">
                <div class="control-group">
                    <label for="signalFrequency">Частота сигнала (Гц)</label>
                    <input type="range" id="signalFrequency" min="1" max="20" step="0.1" value="5">
                    <div class="value-display" id="signalFrequencyValue">5 Гц</div>
                </div>
                
                <div class="control-group">
                    <label for="samplingRate">Частота дискретизации (Гц)</label>
                    <input type="range" id="samplingRate" min="1" max="40" step="1" value="10">
                    <div class="value-display" id="samplingRateValue">10 Гц</div>
                </div>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: rgba(75, 192, 192, 0.8)"></div>
                    <span>Исходный сигнал</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: rgba(255, 99, 132, 0.8)"></div>
                    <span>Точки дискретизации</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: rgba(54, 162, 235, 0.8)"></div>
                    <span>Восстановленный сигнал</span>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="signalChart"></canvas>
            </div>
            
            <div class="description">
                <h2>Текущее состояние:</h2>
                <p id="statusText">Частота дискретизации в 2 раза выше частоты сигнала. Дискретизация выполняется корректно.</p>
            </div>
            
            <div class="button-container">
                <button id="showNyquistButton">Показать границу Найквиста</button>
            </div>
        </div>
    </div>
    
    <div id="guide" class="tab-content">
        <div class="container">
            <h2>Инструкция по использованию</h2>
            <p>Данное приложение демонстрирует процесс дискретизации сигнала и эффект алиасинга. Вы можете:</p>
            <ul>
                <li>Изменять частоту исходного сигнала с помощью первого ползунка</li>
                <li>Регулировать частоту дискретизации с помощью второго ползунка</li>
                <li>Наблюдать, как изменение этих параметров влияет на качество восстановления сигнала</li>
                <li>Видеть, когда возникает эффект алиасинга (при нарушении теоремы Найквиста-Шеннона)</li>
                <li>Использовать кнопку "Показать границу Найквиста" для отображения минимальной допустимой частоты дискретизации</li>
            </ul>
            
            <h3>Что нужно знать:</h3>
            <p>Согласно теореме Найквиста-Шеннона, для корректного восстановления сигнала частота дискретизации должна быть как минимум в 2 раза выше максимальной частоты в сигнале.</p>
            <p>Когда частота дискретизации ниже этого предела, возникает <strong>алиасинг</strong> — искажение сигнала, при котором высокочастотные компоненты "маскируются" под низкочастотные.</p>
        </div>
    </div>
     <footer class="footer">
<div class="container">
<p>© 2025 | kmp | CC BY-NC-SA 4.0<br>
Разработано для студентов БрГУ имени А.С. Пушкина</p>
</div>
</footer>
<div style="position: fixed; bottom: 10px; right: 33px; opacity: 0.3; font-size: 14px;">kmp+</div>
    <script>
        // Получение элементов управления
        const signalFrequencySlider = document.getElementById('signalFrequency');
        const samplingRateSlider = document.getElementById('samplingRate');
        const signalFrequencyValue = document.getElementById('signalFrequencyValue');
        const samplingRateValue = document.getElementById('samplingRateValue');
        const statusText = document.getElementById('statusText');
        const showNyquistButton = document.getElementById('showNyquistButton');
        
        // Настройка переключения вкладок
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // Деактивация всех вкладок и содержимого
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Активация выбранной вкладки и содержимого
                tab.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // Инициализация графика
        const ctx = document.getElementById('signalChart').getContext('2d');
        let signalChart = new Chart(ctx, {
            type: 'line',
            data: {
                datasets: [
                    {
                        label: 'Исходный сигнал',
                        borderColor: 'rgba(75, 192, 192, 0.8)',
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 0,
                        data: []
                    },
                    {
                        label: 'Точки дискретизации',
                        borderColor: 'rgba(255, 99, 132, 0.8)',
                        backgroundColor: 'rgba(255, 99, 132, 0.8)',
                        borderWidth: 0,
                        pointRadius: 5,
                        pointStyle: 'circle',
                        data: []
                    },
                    {
                        label: 'Восстановленный сигнал',
                        borderColor: 'rgba(54, 162, 235, 0.8)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0,
                        data: []
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 0
                },
                scales: {
                    x: {
                        type: 'linear',
                        title: {
                            display: true,
                            text: 'Время (с)'
                        }
                    },
                    y: {
                        min: -1.5,
                        max: 1.5,
                        title: {
                            display: true,
                            text: 'Амплитуда'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
        
        // Обновление отображения значений
        signalFrequencySlider.addEventListener('input', () => {
            signalFrequencyValue.textContent = `${signalFrequencySlider.value} Гц`;
            updateChart();
        });
        
        samplingRateSlider.addEventListener('input', () => {
            samplingRateValue.textContent = `${samplingRateSlider.value} Гц`;
            updateChart();
        });
        
        // Функция для генерации точек исходного сигнала
        function generateSignalPoints(frequency) {
            const points = [];
            const duration = 1; // секунда
            const step = 0.005; // шаг для плавного отображения
            
            for (let t = 0; t <= duration; t += step) {
                points.push({
                    x: t,
                    y: Math.sin(2 * Math.PI * frequency * t)
                });
            }
            
            return points;
        }
        
        // Функция для генерации точек дискретизации
        function generateSamplingPoints(frequency, samplingRate) {
            const points = [];
            const duration = 1; // секунда
            const samplingInterval = 1 / samplingRate;
            
            for (let t = 0; t <= duration; t += samplingInterval) {
                points.push({
                    x: t,
                    y: Math.sin(2 * Math.PI * frequency * t)
                });
            }
            
            return points;
        }
        
        // Функция для восстановления сигнала из дискретных точек
        function reconstructSignal(samplingPoints, frequency, samplingRate) {
            // Используем простую интерполяцию синусами для демонстрации
            const points = [];
            const duration = 1; // секунда
            const step = 0.005; // шаг для плавного отображения
            
            // Если частота дискретизации меньше удвоенной частоты сигнала,
            // моделируем эффект алиасинга
            let effectiveFrequency = frequency;
            if (samplingRate < 2 * frequency) {
                // Простая модель алиасинга для демонстрационных целей
                // В реальности алиасинг более сложный
                effectiveFrequency = samplingRate - (frequency % samplingRate);
                if (effectiveFrequency > samplingRate / 2) {
                    effectiveFrequency = samplingRate - effectiveFrequency;
                }
            }
            
            for (let t = 0; t <= duration; t += step) {
                points.push({
                    x: t,
                    y: Math.sin(2 * Math.PI * effectiveFrequency * t)
                });
            }
            
            return points;
        }
        
        // Функция обновления графика
        function updateChart() {
            const signalFrequency = parseFloat(signalFrequencySlider.value);
            const samplingRate = parseFloat(samplingRateSlider.value);
            
            const signalPoints = generateSignalPoints(signalFrequency);
            const samplingPoints = generateSamplingPoints(signalFrequency, samplingRate);
            const reconstructedPoints = reconstructSignal(samplingPoints, signalFrequency, samplingRate);
            
            signalChart.data.datasets[0].data = signalPoints;
            signalChart.data.datasets[1].data = samplingPoints;
            signalChart.data.datasets[2].data = reconstructedPoints;
            
            signalChart.update();
            
            // Обновление текста статуса
            updateStatus(signalFrequency, samplingRate);
        }
        
        // Функция обновления текста статуса
        function updateStatus(signalFrequency, samplingRate) {
            const nyquistRate = 2 * signalFrequency;
            
            if (samplingRate >= nyquistRate) {
                statusText.innerHTML = `
                    Частота дискретизации (${samplingRate} Гц) в ${(samplingRate / signalFrequency).toFixed(1)} раз(а) 
                    выше частоты сигнала (${signalFrequency} Гц). 
                    <span class="highlight">Дискретизация выполняется корректно.</span>
                `;
            } else {
                statusText.innerHTML = `
                    <span class="highlight">Внимание: Алиасинг!</span> 
                    Частота дискретизации (${samplingRate} Гц) ниже минимальной необходимой частоты 
                    ${nyquistRate} Гц (удвоенной частоты сигнала). 
                    Сигнал невозможно корректно восстановить.
                `;
            }
        }
        
        // Обработчик кнопки показа границы Найквиста
        let nyquistLineVisible = false;
        showNyquistButton.addEventListener('click', () => {
            if (!nyquistLineVisible) {
                // Добавить линию Найквиста
                const signalFrequency = parseFloat(signalFrequencySlider.value);
                const nyquistRate = 2 * signalFrequency;
                
                // Установить значение слайдера на границу Найквиста
                samplingRateSlider.value = nyquistRate;
                samplingRateValue.textContent = `${nyquistRate} Гц`;
                
                showNyquistButton.textContent = "Скрыть границу Найквиста";
                nyquistLineVisible = true;
                
                // Добавляем вертикальную линию для визуализации
                signalChart.options.plugins.annotation = {
                    annotations: {
                        nyquistLine: {
                            type: 'line',
                            yMin: -1.5,
                            yMax: 1.5,
                            xMin: 0,
                            xMax: 0,
                            borderColor: 'rgba(255, 0, 0, 0.7)',
                            borderWidth: 2,
                            label: {
                                content: `Граница Найквиста: ${nyquistRate} Гц`,
                                enabled: true,
                                position: 'top'
                            }
                        }
                    }
                };
            } else {
                // Удалить линию Найквиста
                showNyquistButton.textContent = "Показать границу Найквиста";
                nyquistLineVisible = false;
                
                // Удаляем аннотацию
                delete signalChart.options.plugins.annotation;
            }
            
            updateChart();
        });
        
        // Инициализация графика при загрузке
        updateChart();
        
        // Добавляем интерактивный режим демонстрации алиасинга
        let demoMode = false;
        let demoInterval;
        
        function startDemoMode() {
            if (demoMode) return;
            
            demoMode = true;
            let increasing = true;
            let baseFrequency = parseFloat(signalFrequencySlider.value);
            
            demoInterval = setInterval(() => {
                let currentFrequency = parseFloat(signalFrequencySlider.value);
                
                if (increasing) {
                    currentFrequency += 0.1;
                    if (currentFrequency >= 20) {
                        increasing = false;
                    }
                } else {
                    currentFrequency -= 0.1;
                    if (currentFrequency <= 1) {
                        increasing = true;
                    }
                }
                
                signalFrequencySlider.value = currentFrequency;
                signalFrequencyValue.textContent = `${currentFrequency.toFixed(1)} Гц`;
                updateChart();
                
            }, 100);
        }
        
        function stopDemoMode() {
            if (!demoMode) return;
            
            clearInterval(demoInterval);
            demoMode = false;
        }
        
        // Добавление функции синтеза звука для слухового восприятия алиасинга
        let audioContext;
        let oscillator;
        let isPlaying = false;
        
        function initAudio() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            oscillator = audioContext.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.value = parseFloat(signalFrequencySlider.value);
            oscillator.connect(audioContext.destination);
        }
        
        function toggleAudio() {
            if (!isPlaying) {
                initAudio();
                oscillator.start();
                isPlaying = true;
                audioButton.textContent = 'Выключить звук';
                
                // Обновление частоты при изменении слайдера
                signalFrequencySlider.addEventListener('input', updateAudioFrequency);
            } else {
                oscillator.stop();
                isPlaying = false;
                audioButton.textContent = 'Включить звук';
                
                // Удаление обработчика
                signalFrequencySlider.removeEventListener('input', updateAudioFrequency);
            }
        }
        
        function updateAudioFrequency() {
            if (isPlaying) {
                oscillator.frequency.value = parseFloat(signalFrequencySlider.value);
            }
        }
        
        // Добавляем кнопки для дополнительных функций
        const buttonContainer = document.querySelector('.button-container');
        
        const demoButton = document.createElement('button');
        demoButton.id = 'demoButton';
        demoButton.textContent = 'Запустить демо';
        demoButton.addEventListener('click', () => {
            if (!demoMode) {
                startDemoMode();
                demoButton.textContent = 'Остановить демо';
            } else {
                stopDemoMode();
                demoButton.textContent = 'Запустить демо';
            }
        });
        buttonContainer.appendChild(demoButton);
        
        const audioButton = document.createElement('button');
        audioButton.id = 'audioButton';
        audioButton.textContent = 'Включить звук';
        audioButton.addEventListener('click', toggleAudio);
        buttonContainer.appendChild(audioButton);
    </script>
</body>
</html>