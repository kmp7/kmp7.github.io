<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmp+</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #333333;
            --text-secondary: #666666;
            --header-color: #325980;
            --accent-color: #3498db;
            --border-color: #f1f1f1;
            --card-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --header-color: #4a90c2;
            --accent-color: #5dade2;
            --border-color: #2a2a4a;
            --card-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        header {
            background-color: var(--header-color);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        header h1 {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .theme-toggle {
            background: none;
            border: 0px solid white;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover {
            transform: rotate(180deg);
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .card {
            background-color: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        .card h2 {
            color: var(--header-color);
            margin-bottom: 1rem;
            font-size: 1.3rem;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
        }

        .card h3 {
            color: var(--header-color);
            margin: 1rem 0 0.5rem;
            font-size: 1.1rem;
        }

        .user-input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: border-color 0.3s ease;
        }

        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Game Matrix */
        .game-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
        }

        .matrix-wrapper {
            overflow-x: auto;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .matrix-table th,
        .matrix-table td {
            padding: 1rem;
            text-align: center;
            border: 2px solid var(--border-color);
        }

        .matrix-table th {
            background-color: var(--header-color);
            color: white;
            font-weight: 500;
        }

        .matrix-table td {
            background-color: var(--bg-secondary);
            transition: all 0.3s ease;
        }

        .matrix-table td.nash-equilibrium {
            background-color: #27ae60;
            color: white;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .matrix-table td.pareto-optimal {
            border: 3px solid #f39c12;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .payoff {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .payoff-teacher {
            color: var(--accent-color);
        }

        .payoff-student {
            color: #e74c3c;
        }

        [data-theme="dark"] .payoff-teacher {
            color: #5dade2;
        }

        [data-theme="dark"] .payoff-student {
            color: #f1948a;
        }

        /* Controls */
        .controls {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
        }

        .slider-group {
            margin-bottom: 1rem;
        }

        .slider-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .slider-group input[type="range"] {
            width: 100%;
            cursor: pointer;
        }

        .slider-value {
            text-align: center;
            font-weight: bold;
            color: var(--header-color);
        }

        /* Legend */
        .legend {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--bg-secondary);
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-nash {
            background-color: #27ae60;
        }

        .legend-pareto {
            border: 3px solid #f39c12;
            background-color: transparent;
        }

        /* Analysis */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .analysis-item {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .analysis-item h4 {
            color: var(--header-color);
            margin-bottom: 0.5rem;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--header-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--accent-color);
        }

        .btn-secondary:hover {
            background-color: var(--accent-color);
            color: white;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        /* Scenario selector */
        .scenario-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .scenario-btn {
            padding: 0.5rem 1rem;
            background-color: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .scenario-btn:hover,
        .scenario-btn.active {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

          footer {
      text-align: center;
      padding: 20px 0;
      margin-top: 40px;
      font-size: 0.9rem;
      border-top: 0px solid #ddd;
    }

        /* Info block */
        .info-block {
            background: linear-gradient(135deg, var(--header-color), var(--accent-color));
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .info-block h2 {
            color: white;
            border-bottom-color: rgba(255,255,255,0.3);
        }

        .info-block ul {
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .info-block li {
            margin-bottom: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.1rem;
            }

            .user-input-section,
            .game-container {
                grid-template-columns: 1fr;
            }

            .matrix-table th,
            .matrix-table td {
                padding: 0.5rem;
                font-size: 0.85rem;
            }

            .legend {
                flex-direction: column;
                gap: 0.5rem;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        /* Visualization */
        .visualization {
            margin-top: 1rem;
        }

        .strategy-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            padding: 1rem;
            flex-wrap: wrap;
        }

        .player-box {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            min-width: 150px;
            border: 2px solid var(--border-color);
        }

        .player-box h4 {
            color: var(--header-color);
            margin-bottom: 0.5rem;
        }

        .strategy-choice {
            padding: 0.5rem;
            background-color: var(--accent-color);
            color: white;
            border-radius: 4px;
            margin-top: 0.5rem;
        }

        .arrow {
            font-size: 2rem;
            color: var(--accent-color);
        }

        /* Conclusion preview */
        .conclusion-preview {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            border: 1px dashed var(--accent-color);
        }

        .conclusion-preview h4 {
            color: var(--header-color);
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <header>
        <h1>–†–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ù—ç—à–∞ </h1>
        <button class="theme-toggle" onclick="toggleTheme()" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">‚òÄÔ∏è</button>
    </header>

    <main>
        <!-- Info Block -->
        <div class="info-block">
            <h2>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h2>
            <p>–î–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–æ—Ä–∏–∏ –∏–≥—Ä –∫ –∞–Ω–∞–ª–∏–∑—É –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–≤–µ—Ä–∏—è. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –∫–∞–∫ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—é –ù—ç—à–∞.</p>
            <ul>
                <li><strong>–í–∑–∞–∏–º–Ω–æ—Å—Ç—å:</strong> –î–æ–≤–µ—Ä–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±–æ—é–¥–Ω—ã–º –º–µ–∂–¥—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º –∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–º</li>
                <li><strong>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:</strong> –ö–∞–∂–¥–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è</li>
                <li><strong>–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç:</strong> –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã –ø–µ—Ä–µ–¥ –æ–±—â–µ—Å—Ç–≤–æ–º</li>
            </ul>
            </div>

        <!-- User Input -->
        <div class="card">
            <h2>–î–∞–Ω–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è</h2>
            <div class="user-input-section">
                <div class="input-group">
                    <label for="userName">–í–∞—à–∏ –§–∞–º–∏–ª–∏—è –ò–º—è</label>
                    <input type="text" id="userName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ä–ª–æ–≤–∞ –ï–≤–∞">
                </div>
                <div class="input-group">
                    <label for="userGroup">–í–∞—à–∞ –≥—Ä—É–ø–ø—ã</label>
                    <input type="text" id="userGroup" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
                </div>
            </div>
        </div>

        <!-- Game Theory Model -->
        <div class="card">
            <h2>–¢–µ–æ—Ä–µ—Ç–∏–∫–æ-–∏–≥—Ä–æ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ–≤–µ—Ä–∏—è</h2>
            
            <div class="scenario-buttons">
                <button class="scenario-btn active" onclick="loadScenario('classic')">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å</button>
                <button class="scenario-btn" onclick="loadScenario('cooperative')">–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ä–µ–¥–∞</button>
                <button class="scenario-btn" onclick="loadScenario('competitive')">–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è —Å—Ä–µ–¥–∞</button>
                <button class="scenario-btn" onclick="loadScenario('custom')">–°–≤–æ—è –º–æ–¥–µ–ª—å</button>
            </div>

            <div class="game-container">
                <div class="matrix-wrapper">
                    <h3>–ú–∞—Ç—Ä–∏—Ü–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">
                        –ó–Ω–∞—á–µ–Ω–∏—è: (–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å, –°—Ç—É–¥–µ–Ω—Ç)
                    </p>
                    <table class="matrix-table" id="gameMatrix">
                        <thead>
                            <tr>
                                <th></th>
                                <th>–°—Ç—É–¥–µ–Ω—Ç: –ß–µ—Å—Ç–Ω–æ—Å—Ç—å</th>
                                <th>–°—Ç—É–¥–µ–Ω—Ç: –û–±–º–∞–Ω</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: –î–æ–≤–µ—Ä–∏–µ</th>
                                <td id="cell-0-0">
                                    <span class="payoff payoff-teacher">3</span>, 
                                    <span class="payoff payoff-student">3</span>
                                </td>
                                <td id="cell-0-1">
                                    <span class="payoff payoff-teacher">0</span>, 
                                    <span class="payoff payoff-student">4</span>
                                </td>
                            </tr>
                            <tr>
                                <th>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: –ö–æ–Ω—Ç—Ä–æ–ª—å</th>
                                <td id="cell-1-0">
                                    <span class="payoff payoff-teacher">2</span>, 
                                    <span class="payoff payoff-student">1</span>
                                </td>
                                <td id="cell-1-1">
                                    <span class="payoff payoff-teacher">1</span>, 
                                    <span class="payoff payoff-student">1</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color legend-nash"></div>
                            <span>–†–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ù—ç—à–∞</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color legend-pareto"></div>
                            <span>–ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º—É–º</span>
                        </div>
                        <div class="legend-item">
                            <span class="payoff payoff-teacher">–°–∏–Ω–∏–π</span>
                            <span>‚Äî –≤—ã–∏–≥—Ä—ã—à –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è</span>
                        </div>
                        <div class="legend-item">
                            <span class="payoff payoff-student">–ö—Ä–∞—Å–Ω—ã–π</span>
                            <span>‚Äî –≤—ã–∏–≥—Ä—ã—à —Å—Ç—É–¥–µ–Ω—Ç–∞</span>
                        </div>
                    </div>
                </div>

                <div class="controls" id="customControls" style="display: none;">
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</h3>
                    <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1rem;">
                        –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
                    </p>
                    
                    <div class="slider-group">
                        <label>–î–æ–≤–µ—Ä–∏–µ + –ß–µ—Å—Ç–Ω–æ—Å—Ç—å (–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å): <span class="slider-value" id="val-t-00">3</span></label>
                        <input type="range" min="0" max="5" value="3" id="slider-t-00" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–î–æ–≤–µ—Ä–∏–µ + –ß–µ—Å—Ç–Ω–æ—Å—Ç—å (–°—Ç—É–¥–µ–Ω—Ç): <span class="slider-value" id="val-s-00">3</span></label>
                        <input type="range" min="0" max="5" value="3" id="slider-s-00" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–î–æ–≤–µ—Ä–∏–µ + –û–±–º–∞–Ω (–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å): <span class="slider-value" id="val-t-01">0</span></label>
                        <input type="range" min="0" max="5" value="0" id="slider-t-01" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–î–æ–≤–µ—Ä–∏–µ + –û–±–º–∞–Ω (–°—Ç—É–¥–µ–Ω—Ç): <span class="slider-value" id="val-s-01">4</span></label>
                        <input type="range" min="0" max="5" value="4" id="slider-s-01" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–ö–æ–Ω—Ç—Ä–æ–ª—å + –ß–µ—Å—Ç–Ω–æ—Å—Ç—å (–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å): <span class="slider-value" id="val-t-10">2</span></label>
                        <input type="range" min="0" max="5" value="2" id="slider-t-10" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–ö–æ–Ω—Ç—Ä–æ–ª—å + –ß–µ—Å—Ç–Ω–æ—Å—Ç—å (–°—Ç—É–¥–µ–Ω—Ç): <span class="slider-value" id="val-s-10">1</span></label>
                        <input type="range" min="0" max="5" value="1" id="slider-s-10" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–ö–æ–Ω—Ç—Ä–æ–ª—å + –û–±–º–∞–Ω (–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å): <span class="slider-value" id="val-t-11">1</span></label>
                        <input type="range" min="0" max="5" value="1" id="slider-t-11" onchange="updateMatrix()">
                    </div>
                    <div class="slider-group">
                        <label>–ö–æ–Ω—Ç—Ä–æ–ª—å + –û–±–º–∞–Ω (–°—Ç—É–¥–µ–Ω—Ç): <span class="slider-value" id="val-s-11">1</span></label>
                        <input type="range" min="0" max="5" value="1" id="slider-s-11" onchange="updateMatrix()">
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis -->
        <div class="card">
            <h2>–ê–Ω–∞–ª–∏–∑ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è</h2>
            
            <div class="visualization">
                <div class="strategy-diagram" id="strategyDiagram">
                    <div class="player-box">
                        <h4>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</h4>
                        <p>–õ—É—á—à–∏–π –æ—Ç–≤–µ—Ç:</p>
                        <div class="strategy-choice" id="teacherBestResponse">–ö–æ–Ω—Ç—Ä–æ–ª—å</div>
                    </div>
                    <div class="arrow">‚ü∑</div>
                    <div class="player-box">
                        <h4>–°—Ç—É–¥–µ–Ω—Ç</h4>
                        <p>–õ—É—á—à–∏–π –æ—Ç–≤–µ—Ç:</p>
                        <div class="strategy-choice" id="studentBestResponse">–û–±–º–∞–Ω</div>
                    </div>
                </div>
            </div>

            <div class="analysis-grid">
                <div class="analysis-item">
                    <h4>–†–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ù—ç—à–∞</h4>
                    <p id="nashDescription">
                        –í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (–ö–æ–Ω—Ç—Ä–æ–ª—å, –û–±–º–∞–Ω) —Å –≤—ã–∏–≥—Ä—ã—à–∞–º–∏ (1, 1). 
                        –≠—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–µ–µ –ø—Ä–æ–±–ª–µ–º—É –¥–æ–≤–µ—Ä–∏—è.
                    </p>
                </div>
                <div class="analysis-item">
                    <h4>–ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç—å</h4>
                    <p id="paretoDescription">
                        –ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥ (–î–æ–≤–µ—Ä–∏–µ, –ß–µ—Å—Ç–Ω–æ—Å—Ç—å) —Å –≤—ã–∏–≥—Ä—ã—à–∞–º–∏ (3, 3). 
                        –û–¥–Ω–∞–∫–æ –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ–º ‚Äî —Å—Ç—É–¥–µ–Ω—Ç –∏–º–µ–µ—Ç —Å—Ç–∏–º—É–ª –∫ –æ–±–º–∞–Ω—É.
                    </p>
                </div>
                <div class="analysis-item">
                    <h4>–î–∏–ª–µ–º–º–∞ –¥–æ–≤–µ—Ä–∏—è</h4>
                    <p id="dilemmaDescription">
                        –ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é —Å–æ—Ü–∏–∞–ª—å–Ω—É—é –¥–∏–ª–µ–º–º—É: –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ 
                        –≤–µ–¥—ë—Ç –∫ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.
                    </p>
                </div>
                <div class="analysis-item">
                    <h4>–ü—É—Ç–∏ —Ä–µ—à–µ–Ω–∏—è</h4>
                    <p id="solutionDescription">
                        –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–æ—Ä–º—ã 
                        –º–æ–≥—É—Ç —Å–¥–≤–∏–Ω—É—Ç—å —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –∫ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –∏—Å—Ö–æ–¥—É.
                    </p>
                </div>
            </div>
        </div>

        <!-- Conclusions -->
        <div class="card">
            <h2>–í–∞—à–∏ –≤—ã–≤–æ–¥—ã</h2>
            
            <div class="input-group">
                <label for="conclusion1">1. –ö–∞–∫ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ù—ç—à–∞ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã –¥–æ–≤–µ—Ä–∏—è –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏?</label>
                <textarea id="conclusion1" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–µ–æ—Ä–∏–µ–π –∏–≥—Ä –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –¥–æ–≤–µ—Ä–∏–µ–º..."></textarea>
            </div>
            
            <div class="input-group">
                <label for="conclusion2">2. –ö–∞–∫–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –¥–æ—Å—Ç–∏—á—å –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è?</label>
                <textarea id="conclusion2" placeholder="–ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —Å–ø–æ—Å–æ–±—ã –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è –¥–∏–ª–µ–º–º—ã –¥–æ–≤–µ—Ä–∏—è..."></textarea>
            </div>
            
            <div class="input-group">
                <label for="conclusion3">3. –ö–∞–∫ —ç—Ç–∞ –º–æ–¥–µ–ª—å –ø—Ä–∏–º–µ–Ω–∏–º–∞ –∫ –∏–∑—É—á–µ–Ω–∏—é –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤?</label>
                <textarea id="conclusion3" placeholder="–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è —è–∑—ã–∫–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä–∏–∑–º—É —Ç–µ–æ—Ä–∏–∏ –∏–≥—Ä..."></textarea>
            </div>

            <div class="conclusion-preview" id="conclusionPreview" style="display: none;">
                <h4>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —ç–∫—Å–ø–æ—Ä—Ç–∞</h4>
                <div id="previewContent"></div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previewExport()">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
                <button class="btn btn-primary" onclick="exportToHTML()">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ HTML</button>
                <button class="btn btn-secondary" onclick="resetForm()">–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
            </div>
        </div>
    </main>

    <footer class="footer">
<div class="container">
<p>¬© 2026 | kmp | CC BY-NC-SA 4.0<br>
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ë—Ä–ì–£ –∏–º–µ–Ω–∏ –ê.–°. –ü—É—à–∫–∏–Ω–∞</p>
</div>
</div>
</footer>
<div style="position: fixed; bottom: 10px; right: 33px; opacity: 0.3; font-size: 14px;">kmp+</div>

    <script>
        // Game state
        let gameMatrix = [
            [{t: 3, s: 3}, {t: 0, s: 4}],
            [{t: 2, s: 1}, {t: 1, s: 1}]
        ];

        let currentScenario = 'classic';

        // Scenarios
        const scenarios = {
            classic: {
                name: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å',
                matrix: [
                    [{t: 3, s: 3}, {t: 0, s: 4}],
                    [{t: 2, s: 1}, {t: 1, s: 1}]
                ],
                description: {
                    nash: '–í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (–ö–æ–Ω—Ç—Ä–æ–ª—å, –û–±–º–∞–Ω) —Å –≤—ã–∏–≥—Ä—ã—à–∞–º–∏ (1, 1). –≠—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–µ–µ –ø—Ä–æ–±–ª–µ–º—É –¥–æ–≤–µ—Ä–∏—è.',
                    pareto: '–ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥ (–î–æ–≤–µ—Ä–∏–µ, –ß–µ—Å—Ç–Ω–æ—Å—Ç—å) —Å –≤—ã–∏–≥—Ä—ã—à–∞–º–∏ (3, 3). –û–¥–Ω–∞–∫–æ –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ–º ‚Äî —Å—Ç—É–¥–µ–Ω—Ç –∏–º–µ–µ—Ç —Å—Ç–∏–º—É–ª –∫ –æ–±–º–∞–Ω—É.',
                    dilemma: '–ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é —Å–æ—Ü–∏–∞–ª—å–Ω—É—é –¥–∏–ª–µ–º–º—É: –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–µ–¥—ë—Ç –∫ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.',
                    solution: '–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–æ—Ä–º—ã –º–æ–≥—É—Ç —Å–¥–≤–∏–Ω—É—Ç—å —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –∫ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –∏—Å—Ö–æ–¥—É.'
                }
            },
            cooperative: {
                name: '–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ä–µ–¥–∞',
                matrix: [
                    [{t: 4, s: 4}, {t: 1, s: 2}],
                    [{t: 2, s: 2}, {t: 1, s: 1}]
                ],
                description: {
                    nash: '–í –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ —Å–º–µ—â–∞–µ—Ç—Å—è –∫ (–î–æ–≤–µ—Ä–∏–µ, –ß–µ—Å—Ç–Ω–æ—Å—Ç—å) —Å –≤—ã–∏–≥—Ä—ã—à–∞–º–∏ (4, 4). –í—ã—Å–æ–∫–∏–µ –≤—ã–≥–æ–¥—ã –æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ —Å–Ω–∏–∂–∞—é—Ç —Å—Ç–∏–º—É–ª—ã –∫ –æ–±–º–∞–Ω—É.',
                    pareto: '–ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º—É–º —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ–º –ù—ç—à–∞ ‚Äî —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∏ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã.',
                    dilemma: '–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞ —Å–æ–∑–¥–∞—ë—Ç —É—Å–ª–æ–≤–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —á–µ—Å—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞.',
                    solution: '–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏, –≤–∑–∞–∏–º–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —ç—Ç–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ.'
                }
            },
            competitive: {
                name: '–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è —Å—Ä–µ–¥–∞',
                matrix: [
                    [{t: 2, s: 2}, {t: 0, s: 5}],
                    [{t: 3, s: 0}, {t: 1, s: 1}]
                ],
                description: {
                    nash: '–í –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ä–µ–¥–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ (–ö–æ–Ω—Ç—Ä–æ–ª—å, –û–±–º–∞–Ω) —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è. –í—ã—Å–æ–∫–∏–µ –≤—ã–≥–æ–¥—ã –æ—Ç –æ–±–º–∞–Ω–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–æ–∑–¥–∞—é—Ç –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç–∏—á–µ—Å–∫—É—é –¥–∏–Ω–∞–º–∏–∫—É.',
                    pareto: '–ù–∏ –æ–¥–∏–Ω –∏—Å—Ö–æ–¥ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º ‚Äî —Ç–∏–ø–∏—á–Ω–∞—è —á–µ—Ä—Ç–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —Å—Ä–µ–¥.',
                    dilemma: '–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ –æ—Ü–µ–Ω–∫–∏ —É—Å–∏–ª–∏–≤–∞–µ—Ç —Å—Ç–∏–º—É–ª—ã –∫ –Ω–µ—á–µ—Å—Ç–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é, —Ä–∞–∑—Ä—É—à–∞—è –¥–æ–≤–µ—Ä–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ.',
                    solution: '–ü–µ—Ä–µ—Ö–æ–¥ –∫ —Ñ–æ—Ä–º–∏—Ä—É—é—â–µ–º—É –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—é –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –º–æ–∂–µ—Ç —Å–º—è–≥—á–∏—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ.'
                }
            },
            custom: {
                name: '–°–≤–æ—è –º–æ–¥–µ–ª—å',
                matrix: [
                    [{t: 3, s: 3}, {t: 0, s: 4}],
                    [{t: 2, s: 1}, {t: 1, s: 1}]
                ],
                description: {
                    nash: '–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–∏–≥—Ä—ã—à–µ–π —Å –ø–æ–º–æ—â—å—é –ø–æ–ª–∑—É–Ω–∫–æ–≤ —Å–ø—Ä–∞–≤–∞ –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ.',
                    pareto: '–ò—Å—Å–ª–µ–¥—É–π—Ç–µ, –ø—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö –ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏—Å—Ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ–º –ù—ç—à–∞.',
                    dilemma: '–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –≤—ã–∏–≥—Ä—ã—à–µ–π, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –¥–æ–≤–µ—Ä–∏—è.',
                    solution: '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–π—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —á–µ—Å—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π.'
                }
            }
        };

        // Theme toggle
        function toggleTheme() {
            const body = document.body;
            const btn = document.querySelector('.theme-toggle');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                btn.textContent = '‚òÄÔ∏è';
            } else {
                body.setAttribute('data-theme', 'dark');
                btn.textContent = 'üåô';
            }
        }

        // Load scenario
        function loadScenario(scenario) {
            currentScenario = scenario;
            const buttons = document.querySelectorAll('.scenario-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            const customControls = document.getElementById('customControls');
            if (scenario === 'custom') {
                customControls.style.display = 'block';
            } else {
                customControls.style.display = 'none';
            }

            gameMatrix = JSON.parse(JSON.stringify(scenarios[scenario].matrix));
            updateSliders();
            renderMatrix();
            findNashEquilibrium();
            updateDescriptions(scenario);
        }

        // Update sliders to match matrix
        function updateSliders() {
            const positions = ['00', '01', '10', '11'];
            const coords = [[0,0], [0,1], [1,0], [1,1]];
            
            positions.forEach((pos, idx) => {
                const [i, j] = coords[idx];
                document.getElementById(`slider-t-${pos}`).value = gameMatrix[i][j].t;
                document.getElementById(`slider-s-${pos}`).value = gameMatrix[i][j].s;
                document.getElementById(`val-t-${pos}`).textContent = gameMatrix[i][j].t;
                document.getElementById(`val-s-${pos}`).textContent = gameMatrix[i][j].s;
            });
        }

        // Update matrix from sliders
        function updateMatrix() {
            const positions = ['00', '01', '10', '11'];
            const coords = [[0,0], [0,1], [1,0], [1,1]];
            
            positions.forEach((pos, idx) => {
                const [i, j] = coords[idx];
                gameMatrix[i][j].t = parseInt(document.getElementById(`slider-t-${pos}`).value);
                gameMatrix[i][j].s = parseInt(document.getElementById(`slider-s-${pos}`).value);
                document.getElementById(`val-t-${pos}`).textContent = gameMatrix[i][j].t;
                document.getElementById(`val-s-${pos}`).textContent = gameMatrix[i][j].s;
            });

            scenarios.custom.matrix = JSON.parse(JSON.stringify(gameMatrix));
            renderMatrix();
            findNashEquilibrium();
        }

        // Render matrix
        function renderMatrix() {
            const positions = [[0,0], [0,1], [1,0], [1,1]];
            
            positions.forEach(([i, j]) => {
                const cell = document.getElementById(`cell-${i}-${j}`);
                cell.innerHTML = `
                    <span class="payoff payoff-teacher">${gameMatrix[i][j].t}</span>, 
                    <span class="payoff payoff-student">${gameMatrix[i][j].s}</span>
                `;
                cell.classList.remove('nash-equilibrium', 'pareto-optimal');
            });
        }

        // Find Nash Equilibrium
        function findNashEquilibrium() {
            const nashCells = [];
            const paretoCells = [];
            
            // Check each cell for Nash equilibrium
            for (let i = 0; i < 2; i++) {
                for (let j = 0; j < 2; j++) {
                    let isNash = true;
                    
                    // Check if teacher can improve by switching
                    const otherTeacherRow = 1 - i;
                    if (gameMatrix[otherTeacherRow][j].t > gameMatrix[i][j].t) {
                        isNash = false;
                    }
                    
                    // Check if student can improve by switching
                    const otherStudentCol = 1 - j;
                    if (gameMatrix[i][otherStudentCol].s > gameMatrix[i][j].s) {
                        isNash = false;
                    }
                    
                    if (isNash) {
                        nashCells.push([i, j]);
                    }
                }
            }

            // Find Pareto optimal outcomes
            for (let i = 0; i < 2; i++) {
                for (let j = 0; j < 2; j++) {
                    let isPareto = true;
                    for (let i2 = 0; i2 < 2; i2++) {
                        for (let j2 = 0; j2 < 2; j2++) {
                            if (i2 === i && j2 === j) continue;
                            if (gameMatrix[i2][j2].t >= gameMatrix[i][j].t && 
                                gameMatrix[i2][j2].s >= gameMatrix[i][j].s &&
                                (gameMatrix[i2][j2].t > gameMatrix[i][j].t || 
                                 gameMatrix[i2][j2].s > gameMatrix[i][j].s)) {
                                isPareto = false;
                                break;
                            }
                        }
                        if (!isPareto) break;
                    }
                    if (isPareto) {
                        paretoCells.push([i, j]);
                    }
                }
            }

            // Highlight cells
            paretoCells.forEach(([i, j]) => {
                document.getElementById(`cell-${i}-${j}`).classList.add('pareto-optimal');
            });

            nashCells.forEach(([i, j]) => {
                document.getElementById(`cell-${i}-${j}`).classList.add('nash-equilibrium');
            });

            // Update strategy diagram
            updateStrategyDiagram(nashCells);
        }

        // Update strategy diagram
        function updateStrategyDiagram(nashCells) {
            const teacherResponse = document.getElementById('teacherBestResponse');
            const studentResponse = document.getElementById('studentBestResponse');

            if (nashCells.length > 0) {
                const [i, j] = nashCells[0];
                teacherResponse.textContent = i === 0 ? '–î–æ–≤–µ—Ä–∏–µ' : '–ö–æ–Ω—Ç—Ä–æ–ª—å';
                studentResponse.textContent = j === 0 ? '–ß–µ—Å—Ç–Ω–æ—Å—Ç—å' : '–û–±–º–∞–Ω';
            } else {
                teacherResponse.textContent = '–ù–µ—Ç —á–∏—Å—Ç–æ–≥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è';
                studentResponse.textContent = '–ù–µ—Ç —á–∏—Å—Ç–æ–≥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è';
            }
        }

        // Update descriptions
        function updateDescriptions(scenario) {
            const desc = scenarios[scenario].description;
            document.getElementById('nashDescription').textContent = desc.nash;
            document.getElementById('paretoDescription').textContent = desc.pareto;
            document.getElementById('dilemmaDescription').textContent = desc.dilemma;
            document.getElementById('solutionDescription').textContent = desc.solution;
        }

        // Preview export
        function previewExport() {
            const preview = document.getElementById('conclusionPreview');
            const content = document.getElementById('previewContent');
            
            const userName = document.getElementById('userName').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const userGroup = document.getElementById('userGroup').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const conclusion1 = document.getElementById('conclusion1').value || '–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ';
            const conclusion2 = document.getElementById('conclusion2').value || '–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ';
            const conclusion3 = document.getElementById('conclusion3').value || '–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ';

            content.innerHTML = `
                <p><strong>–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å:</strong> ${userName}</p>
                <p><strong>–ì—Ä—É–ø–ø–∞:</strong> ${userGroup}</p>
                <p><strong>–°—Ü–µ–Ω–∞—Ä–∏–π:</strong> ${scenarios[currentScenario].name}</p>
                <hr style="margin: 0.5rem 0; border-color: var(--border-color);">
                <p><strong>–í—ã–≤–æ–¥ 1:</strong> ${conclusion1.substring(0, 100)}...</p>
            `;

            preview.style.display = 'block';
        }

        // Export to HTML
        function exportToHTML() {
            const userName = document.getElementById('userName').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const userGroup = document.getElementById('userGroup').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const conclusion1 = document.getElementById('conclusion1').value || '–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ';
            const conclusion2 = document.getElementById('conclusion2').value || '–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ';
            const conclusion3 = document.getElementById('conclusion3').value || '–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ';
            const date = new Date().toLocaleDateString('ru-RU');

            const htmlContent = `
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏–∑ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è –ù—ç—à–∞ - ${userName}</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
            color: #333;
        }
        h1 { color: #325980; border-bottom: 3px solid #3498db; padding-bottom: 0.5rem; }
        h2 { color: #325980; margin-top: 1.5rem; }
        .meta { background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; }
        .meta p { margin: 0.25rem 0; }
        .matrix { border-collapse: collapse; width: 100%; margin: 1rem 0; }
        .matrix th, .matrix td { border: 2px solid #ddd; padding: 0.75rem; text-align: center; }
        .matrix th { background: #325980; color: white; }
        .matrix .nash { background: #27ae60; color: white; }
        .conclusion { background: #f5f5f5; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #3498db; }
        .conclusion h3 { color: #325980; margin-top: 0; }
        footer { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ddd; text-align: center; color: #666; font-size: 0.9rem; }
    </style>
</head>
<body>
    <h1>–ê–Ω–∞–ª–∏–∑ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è –ù—ç—à–∞</h1>
    <h3>–≤ –º–æ–¥–µ–ª–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–≤–µ—Ä–∏—è</h3>
    <div class="meta">
        <p><strong>–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å:</strong> ${userName}</p>
        <p><strong>–ì—Ä—É–ø–ø–∞/–ö—É—Ä—Å:</strong> ${userGroup}</p>
        <p><strong>–î–∞—Ç–∞:</strong> ${date}</p>
        <p><strong>–ò—Å—Å–ª–µ–¥—É–µ–º—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:</strong> ${scenarios[currentScenario].name}</p>
    </div>

    <h2>–ú–∞—Ç—Ä–∏—Ü–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</h2>
    <table class="matrix">
        <tr>
            <th></th>
            <th>–°—Ç—É–¥–µ–Ω—Ç: –ß–µ—Å—Ç–Ω–æ—Å—Ç—å</th>
            <th>–°—Ç—É–¥–µ–Ω—Ç: –û–±–º–∞–Ω</th>
        </tr>
        <tr>
            <th>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: –î–æ–≤–µ—Ä–∏–µ</th>
            <td>(${gameMatrix[0][0].t}, ${gameMatrix[0][0].s})</td>
            <td>(${gameMatrix[0][1].t}, ${gameMatrix[0][1].s})</td>
        </tr>
        <tr>
            <th>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: –ö–æ–Ω—Ç—Ä–æ–ª—å</th>
            <td>(${gameMatrix[1][0].t}, ${gameMatrix[1][0].s})</td>
            <td class="nash">(${gameMatrix[1][1].t}, ${gameMatrix[1][1].s})</td>
        </tr>
    </table>
    <p><em>–ó–Ω–∞—á–µ–Ω–∏—è –≤ —Å–∫–æ–±–∫–∞—Ö: (–í—ã–∏–≥—Ä—ã—à –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –í—ã–∏–≥—Ä—ã—à —Å—Ç—É–¥–µ–Ω—Ç–∞)</em></p>

    <h2>–í—ã–≤–æ–¥—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è</h2>
    
    <div class="conclusion">
        <h3>1. –°–≤—è–∑—å —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è –ù—ç—à–∞ –∏ –ø—Ä–æ–±–ª–µ–º –¥–æ–≤–µ—Ä–∏—è –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏</h3>
        <p>${conclusion1}</p>
    </div>
    
    <div class="conclusion">
        <h3>2. –ú–µ—Ö–∞–Ω–∏–∑–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è</h3>
        <p>${conclusion2}</p>
    </div>
    
    <div class="conclusion">
        <h3>3. –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∫ –∏–∑—É—á–µ–Ω–∏—é –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤</h3>
        <p>${conclusion3}</p>
    </div>

    <footer class="footer">
<div class="container">
<p>¬© 2026 | kmp | CC BY-NC-SA 4.0<br>
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ë—Ä–ì–£ –∏–º–µ–Ω–∏ –ê.–°. –ü—É—à–∫–∏–Ω–∞</p>
</div>
</div>
</footer>
</body>
</html>`;

            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nash_analysis_${userName.replace(/\s+/g, '_')}_${date.replace(/\./g, '-')}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Reset form
        function resetForm() {
            document.getElementById('userName').value = '';
            document.getElementById('userGroup').value = '';
            document.getElementById('conclusion1').value = '';
            document.getElementById('conclusion2').value = '';
            document.getElementById('conclusion3').value = '';
            document.getElementById('conclusionPreview').style.display = 'none';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderMatrix();
            findNashEquilibrium();
        });
    </script>
</body>
</html>