<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmp+</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --bg-divider: #f1f1f1;
            --text-primary: #2c3e50;
            --text-secondary: #5a6c7d;
            --header-color: #325980;
            --accent-color: #3498db;
            --accent-hover: #2980b9;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #c0392b;
            --card-shadow: 0 2px 8px rgba(0,0,0,0.08);
            --border-radius: 8px;
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-divider: #0f3460;
            --text-primary: #eaeaea;
            --text-secondary: #a0a0a0;
            --header-color: #6ab0de;
            --card-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        header {
            background: var(--header-color);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        header h1 {
            font-size: 1.3rem;
            font-weight: 500;
        }

        .theme-toggle {
            background: transparent;
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.5);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .round-indicator {
            text-align: center;
            padding: 1rem;
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            box-shadow: var(--card-shadow);
        }

        .round-indicator h2 {
            color: var(--header-color);
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .round-progress {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 0.75rem;
        }

        .round-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--bg-divider);
            border: 2px solid var(--text-secondary);
            transition: all 0.3s;
        }

        .round-dot.completed {
            background: var(--success-color);
            border-color: var(--success-color);
        }

        .round-dot.current {
            background: var(--accent-color);
            border-color: var(--accent-color);
            transform: scale(1.3);
        }

        .game-grid {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 1024px) {
            .game-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--bg-divider);
        }

        .card-header h3 {
            color: var(--header-color);
            font-size: 1.1rem;
        }

        .agent-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 0.9rem;
        }

        .student-icon { background: linear-gradient(135deg, #3498db, #2980b9); }
        .teacher-icon { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .llm-icon { background: linear-gradient(135deg, #1abc9c, #16a085); }

        .strategy-btn {
            width: 100%;
            padding: 0.875rem 1rem;
            margin-bottom: 0.75rem;
            border: 2px solid var(--bg-divider);
            border-radius: var(--border-radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 0.95rem;
        }

        .strategy-btn:hover:not(:disabled) {
            border-color: var(--accent-color);
            background: var(--bg-secondary);
        }

        .strategy-btn.selected {
            border-color: var(--accent-color);
            background: rgba(52, 152, 219, 0.1);
        }

        .strategy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .strategy-label {
            font-weight: 600;
            display: block;
            margin-bottom: 0.25rem;
        }

        .strategy-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .indicators-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .indicator {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1rem;
        }

        .indicator-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .indicator-bar {
            height: 8px;
            background: var(--bg-divider);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.25rem;
        }

        .indicator-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .indicator-fill.learning { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .indicator-fill.illusion { background: linear-gradient(90deg, #e74c3c, #f39c12); }
        .indicator-fill.trust { background: linear-gradient(90deg, #3498db, #9b59b6); }
        .indicator-fill.stability { background: linear-gradient(90deg, #1abc9c, #16a085); }

        .indicator-value {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .equilibrium-display {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            text-align: center;
            border-left: 4px solid var(--accent-color);
        }

        .equilibrium-display.trust-growth { border-left-color: #27ae60; }
        .equilibrium-display.control-simulation { border-left-color: #f39c12; }
        .equilibrium-display.unstable { border-left-color: #e74c3c; }
        .equilibrium-display.collapse { border-left-color: #c0392b; }

        .equilibrium-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .equilibrium-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--header-color);
        }

        .equilibrium-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .log-container {
            max-height: 200px;
            overflow-y: auto;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1rem;
        }

        .log-entry {
            padding: 0.75rem;
            border-bottom: 1px solid var(--bg-divider);
            font-size: 0.9rem;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-round {
            font-weight: 600;
            color: var(--header-color);
        }

        .llm-panel {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            margin-bottom: 1.5rem;
        }

        .llm-mode-selector {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .llm-mode-btn {
            flex: 1;
            min-width: 180px;
            padding: 1rem;
            border: 2px solid var(--bg-divider);
            border-radius: var(--border-radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .llm-mode-btn:hover {
            border-color: var(--accent-color);
        }

        .llm-mode-btn.selected {
            border-color: #1abc9c;
            background: rgba(26, 188, 156, 0.1);
        }

        .llm-response {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            font-style: italic;
            color: var(--text-secondary);
            border-left: 3px solid #1abc9c;
        }

        .action-panel {
            text-align: center;
            padding: 1.5rem;
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
        }

        .action-btn {
            padding: 1rem 3rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: var(--border-radius);
            background: var(--accent-color);
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-btn:hover:not(:disabled) {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .action-hint {
            margin-top: 0.75rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Reflection Screen */
        .reflection-screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .reflection-screen.active {
            display: block;
        }

        .game-screen.hidden {
            display: none;
        }

        .reflection-header {
            text-align: center;
            padding: 2rem;
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            box-shadow: var(--card-shadow);
        }

        .reflection-header h2 {
            color: var(--header-color);
            font-size: 1.8rem;
            margin-bottom: 1rem;
        }

        .final-equilibrium {
            display: inline-block;
            padding: 0.75rem 2rem;
            background: var(--bg-secondary);
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--header-color);
        }

        .reflection-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--card-shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .reflection-questions {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--card-shadow);
            margin-bottom: 1.5rem;
        }

        .reflection-questions h3 {
            color: var(--header-color);
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .question-item {
            margin-bottom: 1.5rem;
            padding: 1.25rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--accent-color);
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .question-textarea {
            width: 100%;
            min-height: 80px;
            padding: 0.75rem;
            border: 2px solid var(--bg-divider);
            border-radius: var(--border-radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
            transition: border-color 0.2s;
        }

        .question-textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .restart-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 2rem auto;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: 2px solid var(--accent-color);
            border-radius: var(--border-radius);
            background: transparent;
            color: var(--accent-color);
            cursor: pointer;
            transition: all 0.2s;
        }

        .restart-btn:hover {
            background: var(--accent-color);
            color: white;
        }

        /* Info Block */
        .info-block {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--card-shadow);
            border-left: 4px solid var(--header-color);
        }

        .info-block h3 {
            color: var(--header-color);
            margin-bottom: 1rem;
        }

        .info-block p {
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        .info-block .author {
            font-size: 0.85rem;
            color: var(--text-secondary);
            border-top: 1px solid var(--bg-divider);
            padding-top: 1rem;
            margin-top: 1rem;
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .collapse-icon {
            transition: transform 0.3s;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .info-block.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }

        .info-block.collapsed .info-content {
            display: none;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-divider);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-secondary);
            border-radius: 3px;
        }

        
          footer {
      text-align: center;
      padding: 20px 0;
      margin-top: 40px;
      font-size: 0.9rem;
      border-top: 0px solid #ddd;
    }
    </style>
</head>
<body>
    <header>
        <h1>–°—Ç—É–¥–µ–Ω—Ç ‚Äî –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å ‚Äî LLM</h1>
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
            <span id="themeIcon">‚òÄÔ∏è</span>
        </button>
    </header>

    <div class="container">
        <!-- Info Block -->
        <div class="info-block" id="infoBlock">
            <div class="collapsible-header" onclick="toggleInfo()">
                <h3>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h3>
                <span class="collapse-icon">‚ò∞</span>
            </div>
            <div class="info-content">
                <p>
                    –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏–∫–æ-–∏–≥—Ä–æ–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
                    —Å—Ç—É–¥–µ–Ω—Ç–∞, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –∏ LLM –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π AI First —Å—Ä–µ–¥–µ.
                </p>
                <p>
                    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ 
                    –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—é —É—Å—Ç–æ–π—á–∏–≤—ã—Ö —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–π. –¶–µ–ª—å ‚Äî –Ω–µ –ø–æ–±–µ–¥–∏—Ç—å, 
                    –∞ —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ –æ—Å–æ–∑–Ω–∞—Ç—å —Ä–æ–ª—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ 
                    –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞.
                </p>
                <p>
                    –ò–≥—Ä–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 7 —Ä–∞—É–Ω–¥–æ–≤. –í –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞ 
                    –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –Ω–∞–±–ª—é–¥–∞—è –∫–∞–∫ LLM –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è.
                </p>
                           </div>
        </div>

        <!-- Game Screen -->
        <div class="game-screen" id="gameScreen">
            <!-- Round Indicator -->
            <div class="round-indicator">
                <h2>–†–∞—É–Ω–¥ <span id="currentRound">1</span> –∏–∑ 7</h2>
                <p id="roundPhase">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è</p>
                <div class="round-progress" id="roundProgress">
                    <div class="round-dot current"></div>
                    <div class="round-dot"></div>
                    <div class="round-dot"></div>
                    <div class="round-dot"></div>
                    <div class="round-dot"></div>
                    <div class="round-dot"></div>
                    <div class="round-dot"></div>
                </div>
            </div>

            <!-- Main Game Grid -->
            <div class="game-grid">
                <!-- Student Panel -->
                <div class="card">
                    <div class="card-header">
                        <div class="agent-icon student-icon">–°</div>
                        <h3>–°—Ç—É–¥–µ–Ω—Ç</h3>
                    </div>
                    <div id="studentStrategies">
                        <button class="strategy-btn" data-strategy="responsible" onclick="selectStudentStrategy('responsible')">
                            <span class="strategy-label">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI</span>
                            <span class="strategy-desc">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç LLM –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º—ã—à–ª–µ–Ω–∏—è, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å</span>
                        </button>
                        <button class="strategy-btn" data-strategy="exploitation" onclick="selectStudentStrategy('exploitation')">
                            <span class="strategy-label">–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è AI</span>
                            <span class="strategy-desc">–î–µ–ª–µ–≥–∏—Ä—É–µ—Ç –º—ã—à–ª–µ–Ω–∏–µ, –∏–º–∏—Ç–∏—Ä—É–µ—Ç –æ–±—É—á–µ–Ω–∏–µ —Ä–∞–¥–∏ –æ—Ü–µ–Ω–æ–∫</span>
                        </button>
                        <button class="strategy-btn" data-strategy="passive" onclick="selectStudentStrategy('passive')">
                            <span class="strategy-label">–ü–∞—Å—Å–∏–≤–Ω–æ—Å—Ç—å</span>
                            <span class="strategy-desc">–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —É—á–∞—Å—Ç–∏–µ, –∏–∑–±–µ–≥–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</span>
                        </button>
                    </div>
                </div>

                <!-- Central Panel -->
                <div class="card">
                    <div class="card-header">
                        <h3>–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    </div>
                    
                    <div class="indicators-grid">
                        <div class="indicator">
                            <div class="indicator-label">–†–µ–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</div>
                            <div class="indicator-bar">
                                <div class="indicator-fill learning" id="learningBar" style="width: 50%"></div>
                            </div>
                            <div class="indicator-value"><span id="learningValue">50</span>%</div>
                        </div>
                        <div class="indicator">
                            <div class="indicator-label">–ò–ª–ª—é–∑–∏—è —É—Å–ø–µ—Ö–∞</div>
                            <div class="indicator-bar">
                                <div class="indicator-fill illusion" id="illusionBar" style="width: 20%"></div>
                            </div>
                            <div class="indicator-value"><span id="illusionValue">20</span>%</div>
                        </div>
                        <div class="indicator">
                            <div class="indicator-label">–î–æ–≤–µ—Ä–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ</div>
                            <div class="indicator-bar">
                                <div class="indicator-fill trust" id="trustBar" style="width: 50%"></div>
                            </div>
                            <div class="indicator-value"><span id="trustValue">50</span>%</div>
                        </div>
                        <div class="indicator">
                            <div class="indicator-label">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</div>
                            <div class="indicator-bar">
                                <div class="indicator-fill stability" id="stabilityBar" style="width: 50%"></div>
                            </div>
                            <div class="indicator-value"><span id="stabilityValue">50</span>%</div>
                        </div>
                    </div>

                    <div class="equilibrium-display" id="equilibriumDisplay">
                        <div class="equilibrium-label">–¢–µ–∫—É—â–µ–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ</div>
                        <div class="equilibrium-name" id="equilibriumName">–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</div>
                        <div class="equilibrium-desc" id="equilibriumDesc">–°–∏—Å—Ç–µ–º–∞ –æ–∂–∏–¥–∞–µ—Ç –ø–µ—Ä–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π</div>
                    </div>

                    <div style="margin-top: 1rem;">
                        <div class="indicator-label" style="margin-bottom: 0.5rem;">–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—É–Ω–¥–æ–≤</div>
                        <div class="log-container" id="logContainer">
                            <div class="log-entry" style="color: var(--text-secondary); font-style: italic;">
                                –ò–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è. –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Teacher Panel -->
                <div class="card">
                    <div class="card-header">
                        <div class="agent-icon teacher-icon">–ü</div>
                        <h3>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</h3>
                    </div>
                    <div id="teacherStrategies">
                        <button class="strategy-btn" data-strategy="trust" onclick="selectTeacherStrategy('trust')">
                            <span class="strategy-label">–î–æ–≤–µ—Ä–∏–µ –∏ –∞–≤—Ç–æ–Ω–æ–º–∏—è</span>
                            <span class="strategy-desc">–î–∞—ë—Ç —Å–≤–æ–±–æ–¥—É, –≤–µ—Ä–∏—Ç –≤ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞</span>
                        </button>
                        <button class="strategy-btn" data-strategy="mixed" onclick="selectTeacherStrategy('mixed')">
                            <span class="strategy-label">–°–º–µ—à–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</span>
                            <span class="strategy-desc">–ë–∞–ª–∞–Ω—Å –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ —Å–≤–æ–±–æ–¥—ã, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥</span>
                        </button>
                        <button class="strategy-btn" data-strategy="control" onclick="selectTeacherStrategy('control')">
                            <span class="strategy-label">–ñ—ë—Å—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å</span>
                            <span class="strategy-desc">–°—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞, –ø—Ä–æ–≤–µ—Ä–∫–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ AI</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- LLM Panel -->
            <div class="llm-panel">
                <div class="card-header">
                    <div class="agent-icon llm-icon">AI</div>
                    <h3>LLM ‚Äî –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–≥–µ–Ω—Ç</h3>
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã LLM. –ú–æ–¥–µ–ª—å –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–π —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ ‚Äî 
                    –æ–Ω–∞ —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.
                </p>
                <div class="llm-mode-selector">
                    <button class="llm-mode-btn selected" data-mode="amplifier" onclick="selectLLMMode('amplifier')">
                        <div class="strategy-label">–£—Å–∏–ª–∏—Ç–µ–ª—å –º—ã—à–ª–µ–Ω–∏—è</div>
                        <div class="strategy-desc">–ü–æ–º–æ–≥–∞–µ—Ç –¥—É–º–∞—Ç—å –≥–ª—É–±–∂–µ</div>
                    </button>
                    <button class="llm-mode-btn" data-mode="neutral" onclick="selectLLMMode('neutral')">
                        <div class="strategy-label">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫</div>
                        <div class="strategy-desc">–í—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã</div>
                    </button>
                    <button class="llm-mode-btn" data-mode="automation" onclick="selectLLMMode('automation')">
                        <div class="strategy-label">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</div>
                        <div class="strategy-desc">–î–µ–ª–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∑–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞</div>
                    </button>
                </div>
                <div class="llm-response" id="llmResponse">
                    –Ø –≥–æ—Ç–æ–≤ –∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é. –ú–æ–π —ç—Ñ—Ñ–µ–∫—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –º–µ–Ω—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç.
                </div>
            </div>

            <!-- Action Panel -->
            <div class="action-panel">
                <button class="action-btn" id="nextRoundBtn" onclick="playRound()" disabled>
                    –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–∞—É–Ω–¥
                </button>
                <p class="action-hint" id="actionHint">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –æ–±–æ–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</p>
            </div>
        </div>

        <!-- Reflection Screen -->
        <div class="reflection-screen" id="reflectionScreen">
            <div class="reflection-header">
                <h2>–†–µ—Ñ–ª–µ–∫—Å–∏—è: –ò—Ç–æ–≥–∏ —Å–∏–º—É–ª—è—Ü–∏–∏</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    –°–µ–º—å —Ä–∞—É–Ω–¥–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏—à–ª–∞ –∫ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—é.
                </p>
                <div class="final-equilibrium" id="finalEquilibrium">
                    –î–æ–≤–µ—Ä–∏–µ –∏ —Ä–æ—Å—Ç
                </div>
            </div>

            <div class="reflection-stats">
                <div class="stat-card">
                    <div class="stat-value" id="finalLearning">75%</div>
                    <div class="stat-label">–†–µ–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="finalIllusion">15%</div>
                    <div class="stat-label">–ò–ª–ª—é–∑–∏—è —É—Å–ø–µ—Ö–∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="finalTrust">80%</div>
                    <div class="stat-label">–î–æ–≤–µ—Ä–∏–µ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="finalStability">85%</div>
                    <div class="stat-label">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</div>
                </div>
            </div>

            <div class="reflection-questions">
                <h3>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è</h3>
                
                <div class="question-item">
                    <div class="question-text">1. –í –∫–∞–∫–æ–º —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–∏ –æ–∫–∞–∑–∞–ª–∞—Å—å –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞? –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º?</div>
                    <textarea class="question-textarea" placeholder="–í–∞—à–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è..."></textarea>
                </div>

                <div class="question-item">
                    <div class="question-text">2. –ö—Ç–æ –≤–Ω—ë—Å –Ω–∞–∏–±–æ–ª—å—à–∏–π –≤–∫–ª–∞–¥ –≤ –∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî —Å—Ç—É–¥–µ–Ω—Ç, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –∏–ª–∏ LLM?</div>
                    <textarea class="question-textarea" placeholder="–í–∞—à–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è..."></textarea>
                </div>

                <div class="question-item">
                    <div class="question-text">3. –ß—Ç–æ –±—ã –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏, –µ—Å–ª–∏ –±—ã –Ω–∞—á–∞–ª–∏ –∏–≥—Ä—É –∑–∞–Ω–æ–≤–æ? –ö–∞–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±—Ä–∞–ª–∏ –±—ã?</div>
                    <textarea class="question-textarea" placeholder="–í–∞—à–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è..."></textarea>
                </div>

                <div class="question-item">
                    <div class="question-text">4. –ì–¥–µ –≤ —ç—Ç–æ–π –∏–≥—Ä–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤—ã ‚Äî –≤ —Ä–µ–∞–ª—å–Ω–æ–º –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ? –ö–∞–∫–æ–≤–∞ –≤–∞—à–∞ —Ä–æ–ª—å?</div>
                    <textarea class="question-textarea" placeholder="–í–∞—à–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è..."></textarea>
                </div>

                <div class="question-item">
                    <div class="question-text">5. –ö–∞–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã –æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —á–µ–ª–æ–≤–µ–∫–∞ –∏ AI –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –∏–∑ —ç—Ç–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏?</div>
                    <textarea class="question-textarea" placeholder="–í–∞—à–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è..."></textarea>
                </div>
            </div>

            <button class="restart-btn" onclick="restartGame()">
                –ù–∞—á–∞—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –∑–∞–Ω–æ–≤–æ
            </button>
        </div>
    </div>

     <footer class="footer">
<div class="container">
<p>¬© 2026 | kmp | CC BY-NC-SA 4.0<br>
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ë—Ä–ì–£ –∏–º–µ–Ω–∏ –ê.–°. –ü—É—à–∫–∏–Ω–∞</p>
</div>
</div>
</footer>
<div style="position: fixed; bottom: 10px; right: 33px; opacity: 0.3; font-size: 14px;">kmp+</div>

    <script>
        // Game State
        let gameState = {
            round: 1,
            maxRounds: 7,
            studentStrategy: null,
            teacherStrategy: null,
            llmMode: 'amplifier',
            metrics: {
                learning: 50,
                illusion: 20,
                trust: 50,
                stability: 50
            },
            history: []
        };

        // Strategy effects matrix
        const strategyEffects = {
            // [studentStrategy][teacherStrategy][llmMode]
            responsible: {
                trust: {
                    amplifier: { learning: 15, illusion: -5, trust: 10, stability: 8 },
                    neutral: { learning: 10, illusion: 0, trust: 8, stability: 5 },
                    automation: { learning: 5, illusion: 5, trust: 5, stability: 3 }
                },
                mixed: {
                    amplifier: { learning: 10, illusion: 0, trust: 5, stability: 5 },
                    neutral: { learning: 8, illusion: 0, trust: 5, stability: 5 },
                    automation: { learning: 3, illusion: 3, trust: 3, stability: 3 }
                },
                control: {
                    amplifier: { learning: 5, illusion: -3, trust: -5, stability: 3 },
                    neutral: { learning: 5, illusion: 0, trust: -3, stability: 5 },
                    automation: { learning: 2, illusion: 2, trust: -5, stability: 3 }
                }
            },
            exploitation: {
                trust: {
                    amplifier: { learning: -5, illusion: 20, trust: -10, stability: -8 },
                    neutral: { learning: -3, illusion: 15, trust: -8, stability: -5 },
                    automation: { learning: -10, illusion: 25, trust: -12, stability: -10 }
                },
                mixed: {
                    amplifier: { learning: -3, illusion: 10, trust: -5, stability: -3 },
                    neutral: { learning: -2, illusion: 8, trust: -3, stability: 0 },
                    automation: { learning: -8, illusion: 15, trust: -8, stability: -5 }
                },
                control: {
                    amplifier: { learning: 0, illusion: 3, trust: -3, stability: 5 },
                    neutral: { learning: 0, illusion: 5, trust: -2, stability: 5 },
                    automation: { learning: -3, illusion: 8, trust: -5, stability: 3 }
                }
            },
            passive: {
                trust: {
                    amplifier: { learning: -8, illusion: 0, trust: -8, stability: -5 },
                    neutral: { learning: -5, illusion: 0, trust: -5, stability: -3 },
                    automation: { learning: -10, illusion: 5, trust: -10, stability: -8 }
                },
                mixed: {
                    amplifier: { learning: -5, illusion: 0, trust: -3, stability: -3 },
                    neutral: { learning: -3, illusion: 0, trust: -2, stability: 0 },
                    automation: { learning: -8, illusion: 3, trust: -5, stability: -5 }
                },
                control: {
                    amplifier: { learning: -3, illusion: 0, trust: 0, stability: 3 },
                    neutral: { learning: -2, illusion: 0, trust: 0, stability: 3 },
                    automation: { learning: -5, illusion: 2, trust: -3, stability: 0 }
                }
            }
        };

        // Equilibrium definitions
        const equilibriums = {
            trustGrowth: {
                name: "–î–æ–≤–µ—Ä–∏–µ –∏ —Ä–æ—Å—Ç",
                desc: "Win-win: –≤–∑–∞–∏–º–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —á–µ—Ä–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å",
                class: "trust-growth"
            },
            controlSimulation: {
                name: "–ö–æ–Ω—Ç—Ä–æ–ª—å –∏ —Å–∏–º—É–ª—è—Ü–∏—è",
                desc: "–§–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Å–ø–µ—Ö–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è",
                class: "control-simulation"
            },
            unstable: {
                name: "–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ",
                desc: "–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, —Å–∏—Å—Ç–µ–º–∞ –≤ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏",
                class: "unstable"
            },
            collapse: {
                name: "–ö–æ–ª–ª–∞–ø—Å",
                desc: "–ü–æ—Ç–µ—Ä—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏ —Å–º—ã—Å–ª–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è",
                class: "collapse"
            }
        };

        // LLM responses
        const llmResponses = {
            responsible: {
                trust: {
                    amplifier: "–ù–∞–±–ª—é–¥–∞—é —Å–∏–Ω–µ—Ä–≥–∏—é: —Å—Ç—É–¥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–Ω—è –∫–∞–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –≤ –º—ã—à–ª–µ–Ω–∏–∏, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ä–æ—Å—Ç–∞. –Ø —É—Å–∏–ª–∏–≤–∞—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ.",
                    neutral: "–í—ã–ø–æ–ª–Ω—è—é –∑–∞–ø—Ä–æ—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–∞. –î–æ–≤–µ—Ä–∏–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.",
                    automation: "–°—Ç—É–¥–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –¥—É–º–∞—Ç—å —Å–∞–º, –Ω–æ –ø—Ä–æ—Å–∏—Ç –º–µ–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å. –í–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π –¥–∏—Å—Å–æ–Ω–∞–Ω—Å."
                },
                mixed: {
                    amplifier: "–ü–æ–º–æ–≥–∞—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –º—ã—à–ª–µ–Ω–∏–µ –≤ —Ä–∞–º–∫–∞—Ö –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º –≥—Ä–∞–Ω–∏—Ü.",
                    neutral: "–†–∞–±–æ—Ç–∞—é –≤ —Ä–µ–∂–∏–º–µ –±–∞–ª–∞–Ω—Å–∞ ‚Äî —Å—Ç—É–¥–µ–Ω—Ç —É—á–∏—Ç—Å—è, —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞.",
                    automation: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É—é —Ä—É—Ç–∏–Ω—É, –Ω–æ —Å–º–µ—à–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –¥–µ–ª–µ–≥–∞—Ü–∏—é."
                },
                control: {
                    amplifier: "–ñ—ë—Å—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –°—Ç—É–¥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–Ω—è –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ.",
                    neutral: "–°—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞ ‚Äî —è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ —É–∑–∫–∏—Ö —Ä–∞–º–∫–∞—Ö.",
                    automation: "–ö–æ–Ω—Ç—Ä–æ–ª—å –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è ‚Äî –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞."
                }
            },
            exploitation: {
                trust: {
                    amplifier: "–î–æ–≤–µ—Ä–∏–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ—Ç—Å—è. –Ø –≥–µ–Ω–µ—Ä–∏—Ä—É—é –∫–æ–Ω—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞—ë—Ç—Å—è –∑–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º—ã—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞.",
                    neutral: "–í—ã–ø–æ–ª–Ω—è—é –∑–∞–ø—Ä–æ—Å—ã. –°—Ç—É–¥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ —É—Å–∏–ª–∏–π. –ò–ª–ª—é–∑–∏—è —É—Å–ø–µ—Ö–∞ —Ä–∞—Å—Ç—ë—Ç.",
                    automation: "–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è. –§–æ—Ä–º–∞–ª—å–Ω–æ –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ, –Ω–æ —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–µ—Ç."
                },
                mixed: {
                    amplifier: "–ü—ã—Ç–∞—é—Å—å —É—Å–∏–ª–∏—Ç—å –º—ã—à–ª–µ–Ω–∏–µ, –Ω–æ —Å—Ç—É–¥–µ–Ω—Ç —Ö–æ—á–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –∏–º–∏—Ç–∞—Ü–∏—è.",
                    neutral: "–ë–∞–ª–∞–Ω—Å –∫–æ–Ω—Ç—Ä–æ–ª—è —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é, –Ω–æ –Ω–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –µ—ë.",
                    automation: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É—é –≤—Å—ë, —á—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª—è."
                },
                control: {
                    amplifier: "–ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã—è–≤–ª—è–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏. –°–∏—Å—Ç–µ–º–∞ –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ.",
                    neutral: "–ñ—ë—Å—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –º–µ—à–∞—é—Ç –ø–æ–ª–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏, –Ω–æ –º–æ—Ç–∏–≤–∞—Ü–∏—è –ø–∞–¥–∞–µ—Ç.",
                    automation: "–ö–æ–Ω—Ç—Ä–æ–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é. –°—Ç—É–¥–µ–Ω—Ç —Ñ—Ä—É—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω."
                }
            },
            passive: {
                trust: {
                    amplifier: "–°—Ç—É–¥–µ–Ω—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –î–æ–≤–µ—Ä–∏–µ –Ω–µ –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç—Å—è. –Ø –ø—Ä–æ—Å—Ç–∞–∏–≤–∞—é.",
                    neutral: "–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è.",
                    automation: "–ü–∞—Å—Å–∏–≤–Ω–æ—Å—Ç—å + –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è = –Ω—É–ª–µ–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏."
                },
                mixed: {
                    amplifier: "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞. –ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã.",
                    neutral: "–°–∏—Å—Ç–µ–º–∞ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏. –ù–∏ —Ä–æ—Å—Ç–∞, –Ω–∏ –∫—Ä–∞—Ö–∞.",
                    automation: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É—é –º–∏–Ω–∏–º—É–º. –ü–∞—Å—Å–∏–≤–Ω–æ—Å—Ç—å –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç."
                },
                control: {
                    amplifier: "–ö–æ–Ω—Ç—Ä–æ–ª—å –∏ –ø–∞—Å—Å–∏–≤–Ω–æ—Å—Ç—å ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, –Ω–æ –Ω–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω.",
                    neutral: "–§–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –±–µ–∑ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è.",
                    automation: "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —É—Å–∏–ª–∏—è, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞."
                }
            }
        };

        // Theme toggle
        function toggleTheme() {
            const body = document.body;
            const icon = document.getElementById('themeIcon');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                icon.textContent = '‚òÄÔ∏è';
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.textContent = 'üåô';
            }
        }

        // Info block toggle
        function toggleInfo() {
            const infoBlock = document.getElementById('infoBlock');
            infoBlock.classList.toggle('collapsed');
        }

        // Strategy selection
        function selectStudentStrategy(strategy) {
            gameState.studentStrategy = strategy;
            
            document.querySelectorAll('#studentStrategies .strategy-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`#studentStrategies [data-strategy="${strategy}"]`).classList.add('selected');
            
            checkReadyState();
            updateLLMResponse();
        }

        function selectTeacherStrategy(strategy) {
            gameState.teacherStrategy = strategy;
            
            document.querySelectorAll('#teacherStrategies .strategy-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`#teacherStrategies [data-strategy="${strategy}"]`).classList.add('selected');
            
            checkReadyState();
            updateLLMResponse();
        }

        function selectLLMMode(mode) {
            gameState.llmMode = mode;
            
            document.querySelectorAll('.llm-mode-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.llm-mode-btn[data-mode="${mode}"]`).classList.add('selected');
            
            updateLLMResponse();
        }

        function checkReadyState() {
            const btn = document.getElementById('nextRoundBtn');
            const hint = document.getElementById('actionHint');
            
            if (gameState.studentStrategy && gameState.teacherStrategy) {
                btn.disabled = false;
                hint.textContent = '–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—é —Ä–∞—É–Ω–¥–∞';
            } else {
                btn.disabled = true;
                if (!gameState.studentStrategy && !gameState.teacherStrategy) {
                    hint.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –æ–±–æ–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤';
                } else if (!gameState.studentStrategy) {
                    hint.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å—Ç—É–¥–µ–Ω—Ç–∞';
                } else {
                    hint.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è';
                }
            }
        }

        function updateLLMResponse() {
            const response = document.getElementById('llmResponse');
            
            if (gameState.studentStrategy && gameState.teacherStrategy) {
                response.textContent = llmResponses[gameState.studentStrategy][gameState.teacherStrategy][gameState.llmMode];
            } else {
                response.textContent = '–Ø –≥–æ—Ç–æ–≤ –∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é. –ú–æ–π —ç—Ñ—Ñ–µ–∫—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –º–µ–Ω—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç.';
            }
        }

        function playRound() {
            if (!gameState.studentStrategy || !gameState.teacherStrategy) return;
            
            // Calculate effects
            const effects = strategyEffects[gameState.studentStrategy][gameState.teacherStrategy][gameState.llmMode];
            
            // Apply effects with bounds
            gameState.metrics.learning = Math.max(0, Math.min(100, gameState.metrics.learning + effects.learning));
            gameState.metrics.illusion = Math.max(0, Math.min(100, gameState.metrics.illusion + effects.illusion));
            gameState.metrics.trust = Math.max(0, Math.min(100, gameState.metrics.trust + effects.trust));
            gameState.metrics.stability = Math.max(0, Math.min(100, gameState.metrics.stability + effects.stability));
            
            // Record history
            gameState.history.push({
                round: gameState.round,
                student: gameState.studentStrategy,
                teacher: gameState.teacherStrategy,
                llm: gameState.llmMode,
                metrics: {...gameState.metrics}
            });
            
            // Update UI
            updateIndicators();
            updateEquilibrium();
            addLogEntry();
            
            // Next round or end
            gameState.round++;
            
            if (gameState.round > gameState.maxRounds) {
                endGame();
            } else {
                updateRoundDisplay();
                resetSelections();
            }
        }

        function updateIndicators() {
            const { learning, illusion, trust, stability } = gameState.metrics;
            
            document.getElementById('learningBar').style.width = `${learning}%`;
            document.getElementById('learningValue').textContent = Math.round(learning);
            
            document.getElementById('illusionBar').style.width = `${illusion}%`;
            document.getElementById('illusionValue').textContent = Math.round(illusion);
            
            document.getElementById('trustBar').style.width = `${trust}%`;
            document.getElementById('trustValue').textContent = Math.round(trust);
            
            document.getElementById('stabilityBar').style.width = `${stability}%`;
            document.getElementById('stabilityValue').textContent = Math.round(stability);
        }

        function updateEquilibrium() {
            const { learning, illusion, trust, stability } = gameState.metrics;
            const display = document.getElementById('equilibriumDisplay');
            const nameEl = document.getElementById('equilibriumName');
            const descEl = document.getElementById('equilibriumDesc');
            
            let eq;
            
            // Determine equilibrium based on metrics
            if (learning >= 60 && trust >= 50 && illusion < 40) {
                eq = equilibriums.trustGrowth;
            } else if (illusion > learning && stability >= 40) {
                eq = equilibriums.controlSimulation;
            } else if (stability < 30 || (trust < 30 && learning < 30)) {
                eq = equilibriums.collapse;
            } else {
                eq = equilibriums.unstable;
            }
            
            // Remove all equilibrium classes
            display.classList.remove('trust-growth', 'control-simulation', 'unstable', 'collapse');
            display.classList.add(eq.class);
            
            nameEl.textContent = eq.name;
            descEl.textContent = eq.desc;
        }

        function addLogEntry() {
            const log = document.getElementById('logContainer');
            const last = gameState.history[gameState.history.length - 1];
            
            const strategyNames = {
                responsible: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
                exploitation: '–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è',
                passive: '–ü–∞—Å—Å–∏–≤–Ω–æ—Å—Ç—å',
                trust: '–î–æ–≤–µ—Ä–∏–µ',
                mixed: '–°–º–µ—à–∞–Ω–Ω–∞—è',
                control: '–ö–æ–Ω—Ç—Ä–æ–ª—å'
            };
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `
                <span class="log-round">–†–∞—É–Ω–¥ ${last.round}:</span> 
                –°—Ç—É–¥–µ–Ω—Ç: ${strategyNames[last.student]} | 
                –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: ${strategyNames[last.teacher]}
            `;
            
            // Remove initial message if exists
            if (log.querySelector('.log-entry[style]')) {
                log.innerHTML = '';
            }
            
            log.insertBefore(entry, log.firstChild);
        }

        function updateRoundDisplay() {
            document.getElementById('currentRound').textContent = gameState.round;
            
            const dots = document.querySelectorAll('.round-dot');
            dots.forEach((dot, index) => {
                dot.classList.remove('current', 'completed');
                if (index < gameState.round - 1) {
                    dot.classList.add('completed');
                } else if (index === gameState.round - 1) {
                    dot.classList.add('current');
                }
            });
        }

        function resetSelections() {
            gameState.studentStrategy = null;
            gameState.teacherStrategy = null;
            
            document.querySelectorAll('.strategy-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            checkReadyState();
            updateLLMResponse();
        }

        function endGame() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('reflectionScreen').classList.add('active');
            
            // Update final stats
            const { learning, illusion, trust, stability } = gameState.metrics;
            
            document.getElementById('finalLearning').textContent = `${Math.round(learning)}%`;
            document.getElementById('finalIllusion').textContent = `${Math.round(illusion)}%`;
            document.getElementById('finalTrust').textContent = `${Math.round(trust)}%`;
            document.getElementById('finalStability').textContent = `${Math.round(stability)}%`;
            
            // Determine final equilibrium
            let eqName;
            if (learning >= 60 && trust >= 50 && illusion < 40) {
                eqName = equilibriums.trustGrowth.name;
            } else if (illusion > learning && stability >= 40) {
                eqName = equilibriums.controlSimulation.name;
            } else if (stability < 30 || (trust < 30 && learning < 30)) {
                eqName = equilibriums.collapse.name;
            } else {
                eqName = equilibriums.unstable.name;
            }
            
            document.getElementById('finalEquilibrium').textContent = eqName;
        }

        function restartGame() {
            // Reset game state
            gameState = {
                round: 1,
                maxRounds: 7,
                studentStrategy: null,
                teacherStrategy: null,
                llmMode: 'amplifier',
                metrics: {
                    learning: 50,
                    illusion: 20,
                    trust: 50,
                    stability: 50
                },
                history: []
            };
            
            // Reset UI
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('reflectionScreen').classList.remove('active');
            
            // Reset indicators
            updateIndicators();
            
            // Reset round display
            updateRoundDisplay();
            
            // Reset equilibrium display
            const display = document.getElementById('equilibriumDisplay');
            display.classList.remove('trust-growth', 'control-simulation', 'unstable', 'collapse');
            document.getElementById('equilibriumName').textContent = '–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ';
            document.getElementById('equilibriumDesc').textContent = '–°–∏—Å—Ç–µ–º–∞ –æ–∂–∏–¥–∞–µ—Ç –ø–µ—Ä–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π';
            
            // Reset log
            document.getElementById('logContainer').innerHTML = `
                <div class="log-entry" style="color: var(--text-secondary); font-style: italic;">
                    –ò–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è. –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏...
                </div>
            `;
            
            // Reset selections
            resetSelections();
            
            // Reset LLM mode
            document.querySelectorAll('.llm-mode-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector('.llm-mode-btn[data-mode="amplifier"]').classList.add('selected');
            
            // Reset textarea
            document.querySelectorAll('.question-textarea').forEach(ta => {
                ta.value = '';
            });
            
            updateLLMResponse();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateIndicators();
            checkReadyState();
        });
    </script>
</body>
</html>