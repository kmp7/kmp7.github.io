<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmp+</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --header-color: #325980;
            --interactive: #3498db;
            --divider: #f1f1f1;
            --text-primary: #333333;
            --text-secondary: #666666;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --shadow: rgba(0, 0, 0, 0.1);
            --card-bg: #ffffff;
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --header-color: #4a90c2;
            --interactive: #5dade2;
            --divider: #2a2a4a;
            --text-primary: #e8e8e8;
            --text-secondary: #b0b0b0;
            --shadow: rgba(0, 0, 0, 0.3);
            --card-bg: #1f1f3a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        header {
            background-color: var(--header-color);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .logo span {
            font-weight: 300;
            opacity: 0.9;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s, transform 0.3s;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(20deg);
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px var(--shadow);
            border: 1px solid var(--divider);
        }

        .card-header {
            color: var(--header-color);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--divider);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-header::before {
            content: '';
            width: 4px;
            height: 24px;
            background-color: var(--interactive);
            border-radius: 2px;
        }

        .user-form {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            align-items: end;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        label {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        input, select, textarea {
            padding: 0.75rem 1rem;
            border: 2px solid var(--divider);
            border-radius: 8px;
            font-size: 1rem;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--interactive);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        button {
            padding: 0.75rem 1.5rem;
            background-color: var(--interactive);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        }

        button:hover {
            background-color: var(--header-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--divider);
        }

        .btn-secondary:hover {
            background-color: var(--divider);
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #219a52;
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .game-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .payoff-matrix {
            overflow-x: auto;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            font-size: 0.95rem;
        }

        .matrix-table th, .matrix-table td {
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--divider);
        }

        .matrix-table th {
            background-color: var(--header-color);
            color: white;
            font-weight: 500;
        }

        .matrix-table td {
            background-color: var(--bg-primary);
        }

        .matrix-table tr:hover td {
            background-color: var(--bg-secondary);
        }

        .game-controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .choice-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .choice-btn {
            padding: 1.5rem;
            font-size: 1.1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .choice-btn.cooperate {
            background-color: var(--success);
        }

        .choice-btn.cooperate:hover {
            background-color: #219a52;
        }

        .choice-btn.defect {
            background-color: var(--danger);
        }

        .choice-btn.defect:hover {
            background-color: #c0392b;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-item {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--interactive);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .history-table th, .history-table td {
            padding: 0.75rem;
            text-align: center;
            border-bottom: 1px solid var(--divider);
        }

        .history-table th {
            background-color: var(--bg-secondary);
            font-weight: 600;
            color: var(--header-color);
        }

        .history-table tbody tr:hover {
            background-color: var(--bg-secondary);
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .badge-cooperate {
            background-color: rgba(39, 174, 96, 0.2);
            color: var(--success);
        }

        .badge-defect {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        .conclusion-area {
            margin-top: 1rem;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            resize: vertical;
        }

        .export-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .info-section {
            background: linear-gradient(135deg, var(--header-color), var(--interactive));
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .info-section h2 {
            margin-bottom: 1rem;
        }

        .info-section p {
            opacity: 0.95;
            margin-bottom: 0.75rem;
        }

        .theory-content {
            display: grid;
            gap: 1rem;
        }

        .theory-item {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--interactive);
        }

        .theory-item h4 {
            color: var(--header-color);
            margin-bottom: 0.5rem;
        }

        .strategy-select {
            margin-bottom: 1rem;
        }

        .round-result {
            background-color: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .result-details {
            color: var(--text-secondary);
        }

          footer {
      text-align: center;
      padding: 20px 0;
      margin-top: 40px;
      font-size: 0.9rem;
      border-top: 0px solid #ddd;
    }

       

        .tabs {
            display: flex;
            border-bottom: 2px solid var(--divider);
            margin-bottom: 1.5rem;
            overflow-x: auto;
        }

        .tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            white-space: nowrap;
        }

        .tab:hover {
            color: var(--interactive);
            background: none;
            transform: none;
            box-shadow: none;
        }

        .tab.active {
            color: var(--interactive);
            border-bottom-color: var(--interactive);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .history-scroll {
            max-height: 300px;
            overflow-y: auto;
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .alert-info {
            background-color: rgba(52, 152, 219, 0.1);
            border: 1px solid var(--interactive);
            color: var(--interactive);
        }

        .alert-warning {
            background-color: rgba(243, 156, 18, 0.1);
            border: 1px solid var(--warning);
            color: var(--warning);
        }

        @media (max-width: 768px) {
            header {
                padding: 1rem;
            }

            .logo {
                font-size: 1.1rem;
            }

            main {
                padding: 1rem;
            }

            .game-grid {
                grid-template-columns: 1fr;
            }

            .user-form {
                grid-template-columns: 1fr;
            }

            .choice-buttons {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .tabs {
                flex-wrap: nowrap;
            }

            .tab {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            .export-buttons {
                flex-direction: column;
            }

            .export-buttons button {
                width: 100%;
            }

            .matrix-table {
                font-size: 0.8rem;
            }

            .matrix-table th, .matrix-table td {
                padding: 0.5rem;
            }
        }

        @media (max-width: 480px) {
            .logo span {
                display: none;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">–î–∏–ª–µ–º–º–∞ –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ <span>| GT</span></div>
        <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">‚òÄÔ∏è</button>
    </header>

    <main>
        <section class="info-section">
            <h2>C–∏–º—É–ª—è—Ü–∏—è –¥–∏–ª–µ–º–º—ã –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ</h2>
            <p>–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Ç–µ–æ—Ä–∏–∏ –∏–≥—Ä –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–µ–¥–∞–≥–æ–≥–∏–∫–∏ –¥–æ–≤–µ—Ä–∏—è. –î–∏–ª–µ–º–º–∞ –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –∏–≥—Ä—ã —Å –Ω–µ–Ω—É–ª–µ–≤–æ–π —Å—É–º–º–æ–π, –≥–¥–µ –≤–∑–∞–∏–º–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ª—É—á—à–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.</p>
            <p>–ò—Å—Å–ª–µ–¥—É–π—Ç–µ, –∫–∞–∫ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –∏—Å—Ö–æ–¥ –∏–≥—Ä—ã, –∏ —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥—ã –æ —Ä–æ–ª–∏ –¥–æ–≤–µ—Ä–∏—è –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.</p>
        </section>

        <div class="card">
            <div class="card-header">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞</div>
            <div class="user-form">
                <div class="form-group">
                    <label for="userName">–§–∞–º–∏–ª–∏—è –ò–º—è</label>
                    <input type="text" id="userName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ä–ª–æ–≤–∞ –ï–≤–∞" required>
                </div>
                <button id="startBtn" onclick="startSession()">–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é</button>
            </div>
        </div>

        <div id="gameSection" style="display: none;">
            <div class="tabs">
                <button class="tab active" onclick="showTab('theory')">–¢–µ–æ—Ä–∏—è</button>
                <button class="tab" onclick="showTab('game')">–°–∏–º—É–ª—è—Ü–∏—è</button>
                <button class="tab" onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</button>
                <button class="tab" onclick="showTab('conclusions')">–í—ã–≤–æ–¥—ã</button>
            </div>

            <div id="theory" class="tab-content active">
                <div class="card">
                    <div class="card-header">–°—É—Ç—å –∏–≥—Ä—ã</div>
                    <div class="theory-content">
                        <div class="theory-item">
                            <p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ —Ç–µ–æ—Ä–∏–∏ –∏–≥—Ä, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∞—è, –ø–æ—á–µ–º—É —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –Ω–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —ç—Ç–æ –≤ –∏—Ö –æ–±—â–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –¥–æ–≤–µ—Ä–∏—è –º–µ–∂–¥—É —É—á–∏—Ç–µ–ª–µ–º –∏ —É—á–µ–Ω–∏–∫–æ–º.</p>
                        </div>
                        <div class="theory-item">
                            <h4>–†–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ù—ç—à–∞</h4>
                            <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –Ω–∏ –æ–¥–∏–Ω –∏–≥—Ä–æ–∫ –Ω–µ –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Å–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∏–∑–º–µ–Ω–∏–≤ —Ç–æ–ª—å–∫–æ —Å–≤–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é. –í –¥–∏–ª–µ–º–º–µ –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ù—ç—à–∞ ‚Äî –≤–∑–∞–∏–º–Ω–æ–µ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, —Ö–æ—Ç—è –≤–∑–∞–∏–º–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –¥–∞—ë—Ç –ª—É—á—à–∏–π —Å–æ–≤–æ–∫—É–ø–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</p>
                        </div>
                        <div class="theory-item">
                            <h4>–ò–≥—Ä—ã —Å –Ω–µ–Ω—É–ª–µ–≤–æ–π —Å—É–º–º–æ–π</h4>
                            <p>–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∏–≥—Ä —Å –Ω—É–ª–µ–≤–æ–π —Å—É–º–º–æ–π, –∑–¥–µ—Å—å –≤—ã–∏–≥—Ä—ã—à –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–æ–∏–≥—Ä—ã—à –¥—Ä—É–≥–æ–≥–æ. –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî —Ç–∏–ø–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä: —É—Å–ø–µ—Ö —É—á–µ–Ω–∏–∫–∞ –Ω–µ —É–º–µ–Ω—å—à–∞–µ—Ç —É—Å–ø–µ—Ö —É—á–∏—Ç–µ–ª—è.</p>
                        </div>
                        <div class="theory-item">
                            <h4>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ</h4>
                            <p>–í–∑–∞–∏–º–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –ö–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–ª–µ–º–º–∞ –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ, –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö.</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">–ú–∞—Ç—Ä–∏—Ü–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</div>
                    <div class="payoff-matrix">
                        <table class="matrix-table">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th colspan="2">–ò–≥—Ä–æ–∫ B (–ö–æ–º–ø—å—é—Ç–µ—Ä)</th>
                                </tr>
                                <tr>
                                    <th>–ò–≥—Ä–æ–∫ A (–í—ã)</th>
                                    <th>–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å</th>
                                    <th>–ü—Ä–µ–¥–∞—Ç—å</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å</th>
                                    <td>3 / 3<br><small>(–í–∑–∞–∏–º–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ)</small></td>
                                    <td>0 / 5<br><small>(–ü—Ä–æ–∏–≥—Ä—ã—à –¥–æ–≤–µ—Ä–∏–≤—à–µ–≥–æ—Å—è)</small></td>
                                </tr>
                                <tr>
                                    <th>–ü—Ä–µ–¥–∞—Ç—å</th>
                                    <td>5 / 0<br><small>(–ò—Å–∫—É—à–µ–Ω–∏–µ –ø—Ä–µ–¥–∞—Ç—å)</small></td>
                                    <td>1 / 1<br><small>(–í–∑–∞–∏–º–Ω–æ–µ –Ω–µ–¥–æ–≤–µ—Ä–∏–µ)</small></td>
                                </tr>
                            </tbody>
                        </table>
                        <p style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.9rem;">
                            –§–æ—Ä–º–∞—Ç: –í–∞—à–∏ –æ—á–∫–∏ / –û—á–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ (3+3=6) –¥–∞—ë—Ç –±–æ–ª—å—à–∏–π –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á–µ–º –≤–∑–∞–∏–º–Ω–æ–µ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ (1+1=2).
                        </p>
                    </div>
                </div>
            </div>

            <div id="game" class="tab-content">
                <div class="game-grid">
                    <div class="card">
                        <div class="card-header">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π</div>
                        
                        <div class="form-group strategy-select">
                            <label for="strategySelect">–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</label>
                            <select id="strategySelect">
                                <option value="titForTat">–û–∫–æ –∑–∞ –æ–∫–æ (Tit-for-Tat)</option>
                                <option value="alwaysCooperate">–í—Å–µ–≥–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å</option>
                                <option value="alwaysDefect">–í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–∞–≤–∞—Ç—å</option>
                                <option value="random">–°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä</option>
                                <option value="grudger">–ó–ª–æ–ø–∞–º—è—Ç–Ω—ã–π (Grudger)</option>
                                <option value="pavlov">–ü–∞–≤–ª–æ–≤ (Win-Stay, Lose-Shift)</option>
                            </select>
                        </div>

                        <div class="alert alert-info">
                            <strong>–†–∞—É–Ω–¥ <span id="currentRound">1</span></strong> ‚Äî –°–¥–µ–ª–∞–π—Ç–µ –≤–∞—à –≤—ã–±–æ—Ä
                        </div>

                        <div class="choice-buttons">
                            <button class="choice-btn cooperate" onclick="makeChoice('cooperate')">
                                <span style="font-size: 1.5rem;">–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å</span>
                                <small>–ü—Ä–æ—è–≤–∏—Ç—å –¥–æ–≤–µ—Ä–∏–µ</small>
                            </button>
                            <button class="choice-btn defect" onclick="makeChoice('defect')">
                                <span style="font-size: 1.5rem;">–ü—Ä–µ–¥–∞—Ç—å</span>
                                <small>–î–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —ç–≥–æ–∏—Å—Ç–∏—á–Ω–æ</small>
                            </button>
                        </div>

                        <div id="roundResult" class="round-result" style="display: none;"></div>

                        <div style="display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
                            <button class="btn-secondary" onclick="resetGame()">–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É</button>
                            <button class="btn-secondary" onclick="autoPlay(10)">–ê–≤—Ç–æ: 10 —Ä–∞—É–Ω–¥–æ–≤</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value" id="playerScore">0</div>
                                <div class="stat-label">–í–∞—à–∏ –æ—á–∫–∏</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="computerScore">0</div>
                                <div class="stat-label">–û—á–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="totalRounds">0</div>
                                <div class="stat-label">–í—Å–µ–≥–æ —Ä–∞—É–Ω–¥–æ–≤</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="cooperationRate">0%</div>
                                <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞</div>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem;">
                            <h4 style="color: var(--header-color); margin-bottom: 0.5rem;">–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h4>
                            <div id="analysisText" style="color: var(--text-secondary); font-size: 0.95rem;">
                                –°—ã–≥—Ä–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞—É–Ω–¥–æ–≤, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∞–Ω–∞–ª–∏–∑.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="history" class="tab-content">
                <div class="card">
                    <div class="card-header">–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—É–Ω–¥–æ–≤</div>
                    <div id="historyContent">
                        <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">
                            –ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –ù–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—É–Ω–¥–æ–≤.
                        </p>
                    </div>
                </div>
            </div>

            <div id="conclusions" class="tab-content">
                <div class="card">
                    <div class="card-header">–í–∞—à–∏ –≤—ã–≤–æ–¥—ã –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è</div>
                    
                    <div class="alert alert-info">
                        –û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –æ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–µ–æ—Ä–∏–µ–π –∏–≥—Ä –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –¥–æ–≤–µ—Ä–∏–µ–º. –ö–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏ —Å–æ–æ—Ç–Ω–æ—Å—è—Ç—Å—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É —É—á–∏—Ç–µ–ª–µ–º –∏ —É—á–µ–Ω–∏–∫–æ–º?
                    </div>

                    <div class="conclusion-area">
                        <div class="form-group">
                            <label for="conclusionText">–¢–µ–∫—Å—Ç –≤—ã–≤–æ–¥–æ–≤</label>
                            <textarea id="conclusionText" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –≤—ã–≤–æ–¥—ã –æ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏...

–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è:
- –ö–∞–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∏ –ø–æ—á–µ–º—É?
- –ö–∞–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É?
- –ö–∞–∫–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º?
- –ö–∞–∫ —Ç–µ–æ—Ä–∏—è –∏–≥—Ä –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–Ω–æ–≥–æ –¥–æ–≤–µ—Ä–∏—è?"></textarea>
                        </div>
                    </div>

                    <div class="export-buttons">
                        <button class="btn-success" onclick="exportToHTML()">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ HTML</button>
                        <button class="btn-secondary" onclick="clearConclusions()">–û—á–∏—Å—Ç–∏—Ç—å –≤—ã–≤–æ–¥—ã</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
            <p>—Å–æ–∑–¥–∞–Ω–æ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –æ—Å–Ω–æ–≤ —Ç–µ–æ—Ä–∏–∏ –∏–≥—Ä –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–µ–¥–∞–≥–æ–≥–∏–∫–∏ –¥–æ–≤–µ—Ä–∏—è. –°–∏–º—É–ª—è—Ü–∏—è –¥–∏–ª–µ–º–º—ã –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–Ω—è—Ç—å –ø—Ä–∏—Ä–æ–¥—É —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö.</p>
            
            <div class="theory-content" style="margin-top: 1rem;">
                <div class="theory-item">
                    <h4>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å</h4>
                    <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏ –ø–µ–¥–∞–≥–æ–≥–∏–∫–∏, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è, —á—Ç–æ –¥–æ–≤–µ—Ä–∏–µ ‚Äî —ç—Ç–æ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ.</p>
                </div>
            </div>

                    </div>
    </main>

   <footer class="footer">
<div class="container">
<p>¬© 2026 | kmp | CC BY-NC-SA 4.0<br>
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ë—Ä–ì–£ –∏–º–µ–Ω–∏ –ê.–°. –ü—É—à–∫–∏–Ω–∞</p>
</div>
</div>
</footer>
<div style="position: fixed; bottom: 10px; right: 33px; opacity: 0.3; font-size: 14px;">kmp+</div>
    <script>
        // Game State
        let gameState = {
            userName: '',
            sessionStarted: false,
            rounds: [],
            playerScore: 0,
            computerScore: 0,
            playerCooperations: 0,
            computerCooperations: 0,
            currentStrategy: 'titForTat',
            grudgerTriggered: false
        };

        // Payoff Matrix
        const PAYOFFS = {
            'cooperate_cooperate': { player: 3, computer: 3 },
            'cooperate_defect': { player: 0, computer: 5 },
            'defect_cooperate': { player: 5, computer: 0 },
            'defect_defect': { player: 1, computer: 1 }
        };

        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        let isDarkTheme = false;

        themeToggle.addEventListener('click', () => {
            isDarkTheme = !isDarkTheme;
            document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
            themeToggle.textContent = isDarkTheme ? 'üåô' : '‚òÄÔ∏è';
            localStorage.setItem('theme', isDarkTheme ? 'dark' : 'light');
        });

        // Load saved theme
        if (localStorage.getItem('theme') === 'dark') {
            isDarkTheme = true;
            document.documentElement.setAttribute('data-theme', 'dark');
            themeToggle.textContent = 'üåô';
        }

        // Tab Navigation
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // Start Session
        function startSession() {
            const userName = document.getElementById('userName').value.trim();
            if (!userName) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è');
                return;
            }
            
            gameState.userName = userName;
            gameState.sessionStarted = true;
            document.getElementById('gameSection').style.display = 'block';
            document.getElementById('startBtn').textContent = '–°–µ—Å—Å–∏—è –Ω–∞—á–∞—Ç–∞';
            document.getElementById('startBtn').disabled = true;
            document.getElementById('userName').disabled = true;
            
            // Scroll to game section
            document.getElementById('gameSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Computer Strategy Functions
        function getComputerChoice() {
            const strategy = document.getElementById('strategySelect').value;
            gameState.currentStrategy = strategy;
            
            switch (strategy) {
                case 'alwaysCooperate':
                    return 'cooperate';
                
                case 'alwaysDefect':
                    return 'defect';
                
                case 'random':
                    return Math.random() < 0.5 ? 'cooperate' : 'defect';
                
                case 'titForTat':
                    if (gameState.rounds.length === 0) return 'cooperate';
                    return gameState.rounds[gameState.rounds.length - 1].playerChoice;
                
                case 'grudger':
                    if (gameState.grudgerTriggered) return 'defect';
                    const hasPlayerDefected = gameState.rounds.some(r => r.playerChoice === 'defect');
                    if (hasPlayerDefected) {
                        gameState.grudgerTriggered = true;
                        return 'defect';
                    }
                    return 'cooperate';
                
                case 'pavlov':
                    if (gameState.rounds.length === 0) return 'cooperate';
                    const lastRound = gameState.rounds[gameState.rounds.length - 1];
                    // Win-Stay: If got 3 or 5 points, keep the same choice
                    // Lose-Shift: If got 0 or 1 points, switch
                    const lastPayoff = PAYOFFS[`${lastRound.computerChoice}_${lastRound.playerChoice}`].computer;
                    if (lastPayoff >= 3) {
                        return lastRound.computerChoice;
                    } else {
                        return lastRound.computerChoice === 'cooperate' ? 'defect' : 'cooperate';
                    }
                
                default:
                    return 'cooperate';
            }
        }

        // Make Choice
        function makeChoice(playerChoice) {
            const computerChoice = getComputerChoice();
            const payoffKey = `${playerChoice}_${computerChoice}`;
            const payoff = PAYOFFS[payoffKey];
            
            gameState.playerScore += payoff.player;
            gameState.computerScore += payoff.computer;
            
            if (playerChoice === 'cooperate') gameState.playerCooperations++;
            if (computerChoice === 'cooperate') gameState.computerCooperations++;
            
            const round = {
                number: gameState.rounds.length + 1,
                playerChoice,
                computerChoice,
                playerPayoff: payoff.player,
                computerPayoff: payoff.computer,
                strategy: gameState.currentStrategy
            };
            
            gameState.rounds.push(round);
            
            updateUI();
            showRoundResult(round);
        }

        // Show Round Result
        function showRoundResult(round) {
            const resultDiv = document.getElementById('roundResult');
            const playerChoiceText = round.playerChoice === 'cooperate' ? '–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å' : '–ü—Ä–µ–¥–∞—Ç—å';
            const computerChoiceText = round.computerChoice === 'cooperate' ? '–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å' : '–ü—Ä–µ–¥–∞—Ç—å';
            
            let resultType = '';
            if (round.playerChoice === 'cooperate' && round.computerChoice === 'cooperate') {
                resultType = '–í–∑–∞–∏–º–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ!';
            } else if (round.playerChoice === 'defect' && round.computerChoice === 'defect') {
                resultType = '–í–∑–∞–∏–º–Ω–æ–µ –Ω–µ–¥–æ–≤–µ—Ä–∏–µ';
            } else if (round.playerChoice === 'cooperate') {
                resultType = '–í–∞—Å –ø—Ä–µ–¥–∞–ª–∏';
            } else {
                resultType = '–í—ã –ø—Ä–µ–¥–∞–ª–∏';
            }
            
            resultDiv.innerHTML = `
                <div class="result-title">${resultType}</div>
                <div class="result-details">
                    –í—ã: ${playerChoiceText} | –ö–æ–º–ø—å—é—Ç–µ—Ä: ${computerChoiceText}<br>
                    –û—á–∫–∏ –∑–∞ —Ä–∞—É–Ω–¥: –í—ã +${round.playerPayoff}, –ö–æ–º–ø—å—é—Ç–µ—Ä +${round.computerPayoff}
                </div>
            `;
            resultDiv.style.display = 'block';
        }

        // Update UI
        function updateUI() {
            document.getElementById('playerScore').textContent = gameState.playerScore;
            document.getElementById('computerScore').textContent = gameState.computerScore;
            document.getElementById('totalRounds').textContent = gameState.rounds.length;
            document.getElementById('currentRound').textContent = gameState.rounds.length + 1;
            
            const totalChoices = gameState.rounds.length * 2;
            const totalCooperations = gameState.playerCooperations + gameState.computerCooperations;
            const cooperationRate = totalChoices > 0 ? Math.round((totalCooperations / totalChoices) * 100) : 0;
            document.getElementById('cooperationRate').textContent = cooperationRate + '%';
            
            updateAnalysis();
            updateHistory();
        }

        // Update Analysis
        function updateAnalysis() {
            const analysisDiv = document.getElementById('analysisText');
            
            if (gameState.rounds.length < 3) {
                analysisDiv.textContent = '–°—ã–≥—Ä–∞–π—Ç–µ –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞—É–Ω–¥–æ–≤ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.';
                return;
            }
            
            const avgPlayerPayoff = (gameState.playerScore / gameState.rounds.length).toFixed(2);
            const avgComputerPayoff = (gameState.computerScore / gameState.rounds.length).toFixed(2);
            const playerCoopRate = Math.round((gameState.playerCooperations / gameState.rounds.length) * 100);
            
            let analysis = `–ó–∞ ${gameState.rounds.length} —Ä–∞—É–Ω–¥–æ–≤ —Å—Ä–µ–¥–Ω–∏–π –≤—ã–∏–≥—Ä—ã—à —Å–æ—Å—Ç–∞–≤–∏–ª: –í—ã ‚Äî ${avgPlayerPayoff}, –ö–æ–º–ø—å—é—Ç–µ—Ä ‚Äî ${avgComputerPayoff}. `;
            analysis += `–í—ã —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞–ª–∏ –≤ ${playerCoopRate}% —Å–ª—É—á–∞–µ–≤. `;
            
            if (gameState.playerScore > gameState.computerScore) {
                analysis += '–í—ã –ª–∏–¥–∏—Ä—É–µ—Ç–µ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.';
            } else if (gameState.playerScore < gameState.computerScore) {
                analysis += '–ö–æ–º–ø—å—é—Ç–µ—Ä –ª–∏–¥–∏—Ä—É–µ—Ç –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.';
            } else {
                analysis += '–°—á—ë—Ç —Ä–∞–≤–Ω—ã–π ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.';
            }
            
            if (avgPlayerPayoff >= 2.5 && avgComputerPayoff >= 2.5) {
                analysis += ' –í—ã—Å–æ–∫–∏–π —Å–æ–≤–æ–∫—É–ø–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ.';
            } else if (avgPlayerPayoff < 2 && avgComputerPayoff < 2) {
                analysis += ' –ù–∏–∑–∫–∏–π —Å–æ–≤–æ–∫—É–ø–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –≤–∑–∞–∏–º–Ω–æ–≥–æ –Ω–µ–¥–æ–≤–µ—Ä–∏—è.';
            }
            
            analysisDiv.textContent = analysis;
        }

        // Update History
        function updateHistory() {
            const historyContent = document.getElementById('historyContent');
            
            if (gameState.rounds.length === 0) {
                historyContent.innerHTML = `
                    <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">
                        –ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –ù–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—É–Ω–¥–æ–≤.
                    </p>
                `;
                return;
            }
            
            let tableHTML = `
                <div class="history-scroll">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>–†–∞—É–Ω–¥</th>
                                <th>–í–∞—à –≤—ã–±–æ—Ä</th>
                                <th>–í—ã–±–æ—Ä –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</th>
                                <th>–í–∞—à–∏ –æ—á–∫–∏</th>
                                <th>–û—á–∫–∏ –∫–æ–º–ø.</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            gameState.rounds.slice().reverse().forEach(round => {
                const playerBadge = round.playerChoice === 'cooperate' 
                    ? '<span class="badge badge-cooperate">–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å</span>'
                    : '<span class="badge badge-defect">–ü—Ä–µ–¥–∞—Ç—å</span>';
                const computerBadge = round.computerChoice === 'cooperate'
                    ? '<span class="badge badge-cooperate">–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å</span>'
                    : '<span class="badge badge-defect">–ü—Ä–µ–¥–∞—Ç—å</span>';
                
                tableHTML += `
                    <tr>
                        <td>${round.number}</td>
                        <td>${playerBadge}</td>
                        <td>${computerBadge}</td>
                        <td>+${round.playerPayoff}</td>
                        <td>+${round.computerPayoff}</td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody></table></div>';
            historyContent.innerHTML = tableHTML;
        }

        // Auto Play
        function autoPlay(rounds) {
            for (let i = 0; i < rounds; i++) {
                const choice = Math.random() < 0.6 ? 'cooperate' : 'defect';
                makeChoice(choice);
            }
        }

        // Reset Game
        function resetGame() {
            gameState.rounds = [];
            gameState.playerScore = 0;
            gameState.computerScore = 0;
            gameState.playerCooperations = 0;
            gameState.computerCooperations = 0;
            gameState.grudgerTriggered = false;
            
            document.getElementById('roundResult').style.display = 'none';
            updateUI();
        }

        // Clear Conclusions
        function clearConclusions() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –≤—ã–≤–æ–¥—ã?')) {
                document.getElementById('conclusionText').value = '';
            }
        }

        // Export to HTML
        function exportToHTML() {
            const conclusions = document.getElementById('conclusionText').value;
            const currentDate = new Date().toLocaleString('ru-RU');
            
            const strategies = {
                'titForTat': '–û–∫–æ –∑–∞ –æ–∫–æ',
                'alwaysCooperate': '–í—Å–µ–≥–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å',
                'alwaysDefect': '–í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–∞–≤–∞—Ç—å',
                'random': '–°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä',
                'grudger': '–ó–ª–æ–ø–∞–º—è—Ç–Ω—ã–π',
                'pavlov': '–ü–∞–≤–ª–æ–≤'
            };
            
            let roundsHTML = '';
            gameState.rounds.forEach(round => {
                roundsHTML += `
                    <tr>
                        <td>${round.number}</td>
                        <td>${round.playerChoice === 'cooperate' ? '–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å' : '–ü—Ä–µ–¥–∞—Ç—å'}</td>
                        <td>${round.computerChoice === 'cooperate' ? '–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å' : '–ü—Ä–µ–¥–∞—Ç—å'}</td>
                        <td>+${round.playerPayoff}</td>
                        <td>+${round.computerPayoff}</td>
                        <td>${strategies[round.strategy] || round.strategy}</td>
                    </tr>
                `;
            });

            const htmlContent = `
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç—á—ë—Ç: –î–∏–ª–µ–º–º–∞ –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ ‚Äî ${gameState.userName}</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        header {
            background-color: #325980;
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }
        h1 { margin: 0 0 0.5rem 0; }
        h2 {
            color: #325980;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }
        .card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        .stat-item {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #3498db;
        }
        .stat-label {
            font-size: 0.85rem;
            color: #666;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        th, td {
            padding: 0.75rem;
            text-align: center;
            border: 1px solid #ddd;
        }
        th {
            background-color: #325980;
            color: white;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .conclusions {
            background: #f5f5f5;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            white-space: pre-wrap;
        }
        .footer {
            text-align: center;
            color: #666;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #ddd;
        }
        .cooperate { color: #27ae60; font-weight: 500; }
        .defect { color: #e74c3c; font-weight: 500; }
    </style>
</head>
<body>
    <header>
        <h1>–û—Ç—á—ë—Ç –ø–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –¥–∏–ª–µ–º–º—ã –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ</h1>
        <p>–£—á–∞—Å—Ç–Ω–∏–∫: <strong>${gameState.userName}</strong></p>
        <p>–î–∞—Ç–∞: ${currentDate}</p>
    </header>

    <div class="card">
        <h2>–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value">${gameState.playerScore}</div>
                <div class="stat-label">–û—á–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">${gameState.computerScore}</div>
                <div class="stat-label">–û—á–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">${gameState.rounds.length}</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ä–∞—É–Ω–¥–æ–≤</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">${gameState.rounds.length > 0 ? Math.round((gameState.playerCooperations / gameState.rounds.length) * 100) : 0}%</div>
                <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—É–Ω–¥–æ–≤</h2>
        ${gameState.rounds.length > 0 ? `
        <table>
            <thead>
                <tr>
                    <th>–†–∞—É–Ω–¥</th>
                    <th>–í—ã–±–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–∞</th>
                    <th>–í—ã–±–æ—Ä –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</th>
                    <th>–û—á–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞</th>
                    <th>–û—á–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</th>
                    <th>–°—Ç—Ä–∞—Ç–µ–≥–∏—è</th>
                </tr>
            </thead>
            <tbody>
                ${roundsHTML}
            </tbody>
        </table>
        ` : '<p>–†–∞—É–Ω–¥—ã –Ω–µ –±—ã–ª–∏ —Å—ã–≥—Ä–∞–Ω—ã.</p>'}
    </div>

    <div class="card">
        <h2>–í—ã–≤–æ–¥—ã —É—á–∞—Å—Ç–Ω–∏–∫–∞</h2>
        <div class="conclusions">${conclusions || '–í—ã–≤–æ–¥—ã –Ω–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã.'}</div>
    </div>

    <div class="card">
        <h2>–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç</h2>
        <p>–î–∏–ª–µ–º–º–∞ –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ –º–µ–∂–¥—É –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –∏ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–º –±–ª–∞–≥–æ–º. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–≤–µ—Ä–∏—è —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:</p>
        <ul>
            <li>–í–∑–∞–∏–º–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –º–µ–∂–¥—É —É—á–∏—Ç–µ–ª–µ–º –∏ —É—á–µ–Ω–∏–∫–æ–º –¥–∞—ë—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ–±–æ–∏—Ö</li>
            <li>–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –¥–æ–≤–µ—Ä–∏—è —Ä–∞–∑—Ä—É—à–∞–µ—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</li>
            <li>–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—é —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞</li>
            <li>–°—Ç—Ä–∞—Ç–µ–≥–∏—è ¬´–æ–∫–æ –∑–∞ –æ–∫–æ¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏ –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –¥–æ–≤–µ—Ä–∏—è</li>
        </ul>
    </div>

    <div class="footer">
        <p>¬© 2026 | kmp | CC BY-NC-SA 4.0<br>
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ë—Ä–ì–£ –∏–º–µ–Ω–∏ –ê.–°. –ü—É—à–∫–∏–Ω–∞</p>
    </div>
</body>
</html>
            `;

            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `–û—Ç—á—ë—Ç_–î–∏–ª–µ–º–º–∞_${gameState.userName.replace(/\s+/g, '_')}_${new Date().toISOString().slice(0,10)}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('userName').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    startSession();
                }
            });
        });
    </script>
</body>
</html>